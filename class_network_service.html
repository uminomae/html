<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>輝く未来をHugっとネ!Happy Go Lucky!ドキドキ!ドキュメント!: NetworkService Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">輝く未来をHugっとネ!Happy Go Lucky!ドキドキ!ドキュメント!
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('class_network_service.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_network_service-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">NetworkService Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for NetworkService:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service__coll__graph.png" border="0" usemap="#a_network_service_coll__map" alt="Collaboration graph"/></div>
<map name="a_network_service_coll__map" id="a_network_service_coll__map">
<area shape="rect" title=" " alt="" coords="243,283,442,1043"/>
<area shape="rect" href="class_port_mapping.html" title=" " alt="" coords="5,5,192,205"/>
<area shape="poly" title=" " alt="" coords="144,204,239,420,234,422,140,206"/>
<area shape="rect" href="class_i_counter.html" title=" " alt="" coords="217,53,306,158"/>
<area shape="poly" title=" " alt="" coords="271,158,287,266,282,267,266,158"/>
<area shape="rect" href="class_mime_type.html" title=" " alt="" coords="331,33,517,178"/>
<area shape="poly" title=" " alt="" coords="416,178,403,267,398,266,411,177"/>
<area shape="rect" href="class_tokenize.html" title=" " alt="" coords="541,33,669,178"/>
<area shape="poly" title=" " alt="" coords="574,179,452,438,447,436,569,176"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1c9039a81ac30d136bc810eba9c8a24b" id="r_a1c9039a81ac30d136bc810eba9c8a24b"><td class="memItemLeft" align="right" valign="top"><a id="a1c9039a81ac30d136bc810eba9c8a24b" name="a1c9039a81ac30d136bc810eba9c8a24b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>NetworkService</b> (std::vector&lt; <a class="el" href="class_server_directive.html">ServerDirective</a> &gt; &amp;ServerDirectives, <a class="el" href="class_port_mapping.html">PortMapping</a> &amp;portMapping, <a class="el" href="class_i_counter.html">ICounter</a> &amp;limiter, <a class="el" href="class_i_counter.html">ICounter</a> &amp;errorCounter, std::map&lt; int, <a class="el" href="class_socket_state.html">SocketState</a> &gt; &amp;socketStates, <a class="el" href="class_mime_type.html">MimeType</a> &amp;mimeType, <a class="el" href="class_tokenize.html">Tokenize</a> &amp;tokenize)</td></tr>
<tr class="separator:a1c9039a81ac30d136bc810eba9c8a24b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa669d89eac68ea824c823701a63c6030" id="r_aa669d89eac68ea824c823701a63c6030"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa669d89eac68ea824c823701a63c6030">initNetworkService</a> ()</td></tr>
<tr class="memdesc:aa669d89eac68ea824c823701a63c6030"><td class="mdescLeft">&#160;</td><td class="mdescRight">ネットワークサービスを初期化します。  <br /></td></tr>
<tr class="separator:aa669d89eac68ea824c823701a63c6030"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54ae0e59338c8ffd4aabd39866bbf549" id="r_a54ae0e59338c8ffd4aabd39866bbf549"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a54ae0e59338c8ffd4aabd39866bbf549">restartNetworkService</a> ()</td></tr>
<tr class="memdesc:a54ae0e59338c8ffd4aabd39866bbf549"><td class="mdescLeft">&#160;</td><td class="mdescRight">ネットワークサービスを再起動します。  <br /></td></tr>
<tr class="separator:a54ae0e59338c8ffd4aabd39866bbf549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44006dbf443e41fff6a628d72e356dd3" id="r_a44006dbf443e41fff6a628d72e356dd3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44006dbf443e41fff6a628d72e356dd3">setupEachServer</a> (const <a class="el" href="class_server_directive.html">ServerDirective</a> &amp;config)</td></tr>
<tr class="memdesc:a44006dbf443e41fff6a628d72e356dd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">.confのサーバーディレクティブの設定に基づいてセットアップを行います。  <br /></td></tr>
<tr class="separator:a44006dbf443e41fff6a628d72e356dd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34440b127df8820b685c1fd564b0a558" id="r_a34440b127df8820b685c1fd564b0a558"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a34440b127df8820b685c1fd564b0a558">switchToNonBlockingSocket</a> (int sock)</td></tr>
<tr class="memdesc:a34440b127df8820b685c1fd564b0a558"><td class="mdescLeft">&#160;</td><td class="mdescRight">指定されたソケットをノンブロッキングモードに設定します。  <br /></td></tr>
<tr class="separator:a34440b127df8820b685c1fd564b0a558"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b7f72724577a0fba37802fb36d8e7d" id="r_a18b7f72724577a0fba37802fb36d8e7d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a18b7f72724577a0fba37802fb36d8e7d">acceptNewConnection</a> (size_t serverIndex)</td></tr>
<tr class="memdesc:a18b7f72724577a0fba37802fb36d8e7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">新しいクライアント接続を受け入れます。  <br /></td></tr>
<tr class="separator:a18b7f72724577a0fba37802fb36d8e7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79b34078f8a4e6c978ab8fae8e4769db" id="r_a79b34078f8a4e6c978ab8fae8e4769db"><td class="memItemLeft" align="right" valign="top">PollAction&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a79b34078f8a4e6c978ab8fae8e4769db">handlePoll</a> (std::vector&lt; struct pollfd &gt; &amp;fds)</td></tr>
<tr class="memdesc:a79b34078f8a4e6c978ab8fae8e4769db"><td class="mdescLeft">&#160;</td><td class="mdescRight">poll()を使用してファイルディスクリプタのイベントを待ちます。  <br /></td></tr>
<tr class="separator:a79b34078f8a4e6c978ab8fae8e4769db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79b80b9a51d73a85bb99b0ac0560a0c4" id="r_a79b80b9a51d73a85bb99b0ac0560a0c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a79b80b9a51d73a85bb99b0ac0560a0c4">handleServerEvents</a> ()</td></tr>
<tr class="memdesc:a79b80b9a51d73a85bb99b0ac0560a0c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">全てのサーバーsocket(port)でPOLLINフラグをチェックします <br  />
  <br /></td></tr>
<tr class="separator:a79b80b9a51d73a85bb99b0ac0560a0c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc2ce78b98367413538d7d84537b867e" id="r_afc2ce78b98367413538d7d84537b867e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afc2ce78b98367413538d7d84537b867e">handleRecvRequests</a> ()</td></tr>
<tr class="memdesc:afc2ce78b98367413538d7d84537b867e"><td class="mdescLeft">&#160;</td><td class="mdescRight">すべてのクライアントソケットからのリクエストを処理します。  <br /></td></tr>
<tr class="separator:afc2ce78b98367413538d7d84537b867e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16ed9bd4de8e026601eca26611647507" id="r_a16ed9bd4de8e026601eca26611647507"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16ed9bd4de8e026601eca26611647507">closeAndCleanupSocket</a> (std::vector&lt; struct pollfd &gt;::iterator &amp;it)</td></tr>
<tr class="memdesc:a16ed9bd4de8e026601eca26611647507"><td class="mdescLeft">&#160;</td><td class="mdescRight">ソケットを閉じ、関連するリソースをクリーンアップします。  <br /></td></tr>
<tr class="separator:a16ed9bd4de8e026601eca26611647507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8849b9c719cb649dbbbae76d9981da7c" id="r_a8849b9c719cb649dbbbae76d9981da7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8849b9c719cb649dbbbae76d9981da7c">handleSendResponses</a> ()</td></tr>
<tr class="memdesc:a8849b9c719cb649dbbbae76d9981da7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">クライアントへの応答を処理します。  <br /></td></tr>
<tr class="separator:a8849b9c719cb649dbbbae76d9981da7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cf75b7a3d9f4f6ffb04501be4a4f151" id="r_a2cf75b7a3d9f4f6ffb04501be4a4f151"><td class="memItemLeft" align="right" valign="top"><a id="a2cf75b7a3d9f4f6ffb04501be4a4f151" name="a2cf75b7a3d9f4f6ffb04501be4a4f151"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>closeAndResetAllSockets</b> ()</td></tr>
<tr class="memdesc:a2cf75b7a3d9f4f6ffb04501be4a4f151"><td class="mdescLeft">&#160;</td><td class="mdescRight">すべてのソケットの接続を閉じ、関係するデータを削除します。 <br /></td></tr>
<tr class="separator:a2cf75b7a3d9f4f6ffb04501be4a4f151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcb47d4f7a2c0a5b7f7cb5b3f80a1d55" id="r_afcb47d4f7a2c0a5b7f7cb5b3f80a1d55"><td class="memItemLeft" align="right" valign="top"><a id="afcb47d4f7a2c0a5b7f7cb5b3f80a1d55" name="afcb47d4f7a2c0a5b7f7cb5b3f80a1d55"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>getServPort</b> () const</td></tr>
<tr class="separator:afcb47d4f7a2c0a5b7f7cb5b3f80a1d55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3f6094050fc69198ef9b005c1294d44" id="r_af3f6094050fc69198ef9b005c1294d44"><td class="memItemLeft" align="right" valign="top"><a id="af3f6094050fc69198ef9b005c1294d44" name="af3f6094050fc69198ef9b005c1294d44"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>getServSockFd</b> () const</td></tr>
<tr class="separator:af3f6094050fc69198ef9b005c1294d44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a108a101d3e082fdfa5e46c8131532e7e" id="r_a108a101d3e082fdfa5e46c8131532e7e"><td class="memItemLeft" align="right" valign="top"><a id="a108a101d3e082fdfa5e46c8131532e7e" name="a108a101d3e082fdfa5e46c8131532e7e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setServSockFd</b> (int servSockFd)</td></tr>
<tr class="separator:a108a101d3e082fdfa5e46c8131532e7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0184b7ae82703d67718a3be83948c5bd" id="r_a0184b7ae82703d67718a3be83948c5bd"><td class="memItemLeft" align="right" valign="top"><a id="a0184b7ae82703d67718a3be83948c5bd" name="a0184b7ae82703d67718a3be83948c5bd"></a>
std::map&lt; int, <a class="el" href="class_socket_state.html">SocketState</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>getReqSocketStatesPtr</b> () const</td></tr>
<tr class="separator:a0184b7ae82703d67718a3be83948c5bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a0ef4a420379a073d298d4b7e5f650c7a" id="r_a0ef4a420379a073d298d4b7e5f650c7a"><td class="memItemLeft" align="right" valign="top"><a id="a0ef4a420379a073d298d4b7e5f650c7a" name="a0ef4a420379a073d298d4b7e5f650c7a"></a>
<a class="el" href="class_mime_type.html">MimeType</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>_mimeType</b></td></tr>
<tr class="separator:a0ef4a420379a073d298d4b7e5f650c7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a383c592b347a6926852884b916875aa4" id="r_a383c592b347a6926852884b916875aa4"><td class="memItemLeft" align="right" valign="top"><a id="a383c592b347a6926852884b916875aa4" name="a383c592b347a6926852884b916875aa4"></a>
<a class="el" href="class_tokenize.html">Tokenize</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>_tokenize</b></td></tr>
<tr class="separator:a383c592b347a6926852884b916875aa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d8ed2b2b9150e8d9038c5f160c49e00" id="r_a0d8ed2b2b9150e8d9038c5f160c49e00"><td class="memItemLeft" align="right" valign="top"><a id="a0d8ed2b2b9150e8d9038c5f160c49e00" name="a0d8ed2b2b9150e8d9038c5f160c49e00"></a>
std::vector&lt; struct pollfd &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>_clientFds</b></td></tr>
<tr class="separator:a0d8ed2b2b9150e8d9038c5f160c49e00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8af280b5f9996426d5a0e8f24d9f1f6" id="r_af8af280b5f9996426d5a0e8f24d9f1f6"><td class="memItemLeft" align="right" valign="top"><a id="af8af280b5f9996426d5a0e8f24d9f1f6" name="af8af280b5f9996426d5a0e8f24d9f1f6"></a>
std::vector&lt; struct pollfd &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>_pollfds</b></td></tr>
<tr class="separator:af8af280b5f9996426d5a0e8f24d9f1f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1083a87439bed90f21aa6198f809a83" id="r_ab1083a87439bed90f21aa6198f809a83"><td class="memItemLeft" align="right" valign="top"><a id="ab1083a87439bed90f21aa6198f809a83" name="ab1083a87439bed90f21aa6198f809a83"></a>
std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>_serverFds</b></td></tr>
<tr class="separator:ab1083a87439bed90f21aa6198f809a83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa51dfae33d18dd1f445fe6c205232510" id="r_aa51dfae33d18dd1f445fe6c205232510"><td class="memItemLeft" align="right" valign="top"><a id="aa51dfae33d18dd1f445fe6c205232510" name="aa51dfae33d18dd1f445fe6c205232510"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>_MimeTypeFileName</b></td></tr>
<tr class="separator:aa51dfae33d18dd1f445fe6c205232510"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a819fb704e1701d18f7e5562bb63b3174" id="r_a819fb704e1701d18f7e5562bb63b3174"><td class="memItemLeft" align="right" valign="top"><a id="a819fb704e1701d18f7e5562bb63b3174" name="a819fb704e1701d18f7e5562bb63b3174"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>_pollTimeout</b></td></tr>
<tr class="separator:a819fb704e1701d18f7e5562bb63b3174"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:acf04155926d7461e63432034869d23b7" id="r_acf04155926d7461e63432034869d23b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf04155926d7461e63432034869d23b7">createServerSocket</a> ()</td></tr>
<tr class="memdesc:acf04155926d7461e63432034869d23b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">サーバーソケットを作成します。  <br /></td></tr>
<tr class="separator:acf04155926d7461e63432034869d23b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb307c95e97d912803bff29f67f533ca" id="r_abb307c95e97d912803bff29f67f533ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abb307c95e97d912803bff29f67f533ca">configureServerAddress</a> ()</td></tr>
<tr class="memdesc:abb307c95e97d912803bff29f67f533ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">サーバーアドレスを設定します。  <br /></td></tr>
<tr class="separator:abb307c95e97d912803bff29f67f533ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76eb3eb24ee923721a827e11d5bf7234" id="r_a76eb3eb24ee923721a827e11d5bf7234"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a76eb3eb24ee923721a827e11d5bf7234">bindAddr</a> ()</td></tr>
<tr class="memdesc:a76eb3eb24ee923721a827e11d5bf7234"><td class="mdescLeft">&#160;</td><td class="mdescRight">サーバーソケットにアドレスをバインドします。  <br /></td></tr>
<tr class="separator:a76eb3eb24ee923721a827e11d5bf7234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e89f1cabbeac6f1b6f8fd5c2fdc49df" id="r_a9e89f1cabbeac6f1b6f8fd5c2fdc49df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9e89f1cabbeac6f1b6f8fd5c2fdc49df">listenSocket</a> (const <a class="el" href="class_server_directive.html">ServerDirective</a> &amp;config)</td></tr>
<tr class="memdesc:a9e89f1cabbeac6f1b6f8fd5c2fdc49df"><td class="mdescLeft">&#160;</td><td class="mdescRight">サーバーソケットをリスニング状態に設定します。  <br /></td></tr>
<tr class="separator:a9e89f1cabbeac6f1b6f8fd5c2fdc49df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63bbb5ebfaed19591fb547b3f0cfffc5" id="r_a63bbb5ebfaed19591fb547b3f0cfffc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a63bbb5ebfaed19591fb547b3f0cfffc5">mapClientSocketToListeningPort</a> (int clientSocket, int serverIndex)</td></tr>
<tr class="memdesc:a63bbb5ebfaed19591fb547b3f0cfffc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">クライアントソケットとリスニングポートのマッピングを設定します。  <br /></td></tr>
<tr class="separator:a63bbb5ebfaed19591fb547b3f0cfffc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae230dece0329581a121b72f4437e0518" id="r_ae230dece0329581a121b72f4437e0518"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae230dece0329581a121b72f4437e0518">createSocketState</a> (size_t serverIndex, int clientSocket)</td></tr>
<tr class="memdesc:ae230dece0329581a121b72f4437e0518"><td class="mdescLeft">&#160;</td><td class="mdescRight">クライアントの状態をもつクラスのインスタンスを作成し、配列に追加します。  <br /></td></tr>
<tr class="separator:ae230dece0329581a121b72f4437e0518"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fecddc50e233048c7e1632913dff0b5" id="r_a6fecddc50e233048c7e1632913dff0b5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6fecddc50e233048c7e1632913dff0b5">addSocketToPollFd</a> (int socket, std::vector&lt; struct pollfd &gt; &amp;fd)</td></tr>
<tr class="memdesc:a6fecddc50e233048c7e1632913dff0b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">新しいソケットを監視リストに追加します。  <br /></td></tr>
<tr class="separator:a6fecddc50e233048c7e1632913dff0b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25d68e6cd94f5f887a72a4a7458b3bd2" id="r_a25d68e6cd94f5f887a72a4a7458b3bd2"><td class="memItemLeft" align="right" valign="top"><a id="a25d68e6cd94f5f887a72a4a7458b3bd2" name="a25d68e6cd94f5f887a72a4a7458b3bd2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>recvRequest</b> (int socketFd, std::vector&lt; char &gt; &amp;recvData, ssize_t &amp;recvMsgSize)</td></tr>
<tr class="separator:a25d68e6cd94f5f887a72a4a7458b3bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b6605ad0ddb71f1fc7a87ff616cf872" id="r_a1b6605ad0ddb71f1fc7a87ff616cf872"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1b6605ad0ddb71f1fc7a87ff616cf872">executeClientHttpSession</a> (int socketFd)</td></tr>
<tr class="memdesc:a1b6605ad0ddb71f1fc7a87ff616cf872"><td class="mdescLeft">&#160;</td><td class="mdescRight">クライアントのHTTPセッションを実行します。  <br /></td></tr>
<tr class="separator:a1b6605ad0ddb71f1fc7a87ff616cf872"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9cd04add0e426e95a9fc680b06db23e" id="r_af9cd04add0e426e95a9fc680b06db23e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af9cd04add0e426e95a9fc680b06db23e">sendResponse</a> (int socketFd, const char *msg, size_t len)</td></tr>
<tr class="memdesc:af9cd04add0e426e95a9fc680b06db23e"><td class="mdescLeft">&#160;</td><td class="mdescRight">クライアントソケットへの応答メッセージを送信します。  <br /></td></tr>
<tr class="separator:af9cd04add0e426e95a9fc680b06db23e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0244f33afb37171b6fe2c73c4077663" id="r_ab0244f33afb37171b6fe2c73c4077663"><td class="memItemLeft" align="right" valign="top"><a id="ab0244f33afb37171b6fe2c73c4077663" name="ab0244f33afb37171b6fe2c73c4077663"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>shouldCloseSocket</b> (int socketFd)</td></tr>
<tr class="separator:ab0244f33afb37171b6fe2c73c4077663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2dc5eec9dfb61797bd77abf5a44a218" id="r_aa2dc5eec9dfb61797bd77abf5a44a218"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa2dc5eec9dfb61797bd77abf5a44a218">shouldKeepAlive</a> (int socketFd)</td></tr>
<tr class="memdesc:aa2dc5eec9dfb61797bd77abf5a44a218"><td class="mdescLeft">&#160;</td><td class="mdescRight">クライアントのリクエストヘッダーに "Connection: keep-alive" が存在するか確認します。  <br /></td></tr>
<tr class="separator:aa2dc5eec9dfb61797bd77abf5a44a218"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7101de80b1b3b348f2012246c598b0e4" id="r_a7101de80b1b3b348f2012246c598b0e4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7101de80b1b3b348f2012246c598b0e4">isServerFd</a> (std::vector&lt; struct pollfd &gt;::iterator &amp;itPollFds)</td></tr>
<tr class="memdesc:a7101de80b1b3b348f2012246c598b0e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">引数のイテレータがサーバーソケットを指しているかどうかを判断します。  <br /></td></tr>
<tr class="separator:a7101de80b1b3b348f2012246c598b0e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a648626623792dd4752c1daaffe876ffc" id="r_a648626623792dd4752c1daaffe876ffc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a648626623792dd4752c1daaffe876ffc">closeConnection</a> (int socketFd)</td></tr>
<tr class="memdesc:a648626623792dd4752c1daaffe876ffc"><td class="mdescLeft">&#160;</td><td class="mdescRight">指定されたソケットの接続を閉じます。  <br /></td></tr>
<tr class="separator:a648626623792dd4752c1daaffe876ffc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ae2db67bb7170de0f239abb8488cdb196" id="r_ae2db67bb7170de0f239abb8488cdb196"><td class="memItemLeft" align="right" valign="top"><a id="ae2db67bb7170de0f239abb8488cdb196" name="ae2db67bb7170de0f239abb8488cdb196"></a>
std::vector&lt; <a class="el" href="class_server_directive.html">ServerDirective</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>_serverDirectives</b></td></tr>
<tr class="separator:ae2db67bb7170de0f239abb8488cdb196"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafd0e15a83d135bddfe8b508620538c1" id="r_aafd0e15a83d135bddfe8b508620538c1"><td class="memItemLeft" align="right" valign="top"><a id="aafd0e15a83d135bddfe8b508620538c1" name="aafd0e15a83d135bddfe8b508620538c1"></a>
<a class="el" href="class_port_mapping.html">PortMapping</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>_portMapping</b></td></tr>
<tr class="separator:aafd0e15a83d135bddfe8b508620538c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c2558411c6168f0f5f25b29ef72383d" id="r_a7c2558411c6168f0f5f25b29ef72383d"><td class="memItemLeft" align="right" valign="top"><a id="a7c2558411c6168f0f5f25b29ef72383d" name="a7c2558411c6168f0f5f25b29ef72383d"></a>
<a class="el" href="class_i_counter.html">ICounter</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>_limiter</b></td></tr>
<tr class="separator:a7c2558411c6168f0f5f25b29ef72383d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad74a105b61a08ac668bd1648ac660e61" id="r_ad74a105b61a08ac668bd1648ac660e61"><td class="memItemLeft" align="right" valign="top"><a id="ad74a105b61a08ac668bd1648ac660e61" name="ad74a105b61a08ac668bd1648ac660e61"></a>
<a class="el" href="class_i_counter.html">ICounter</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>_errorCounter</b></td></tr>
<tr class="separator:ad74a105b61a08ac668bd1648ac660e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0127a0e28a6e25fd02f761bbe79a9b67" id="r_a0127a0e28a6e25fd02f761bbe79a9b67"><td class="memItemLeft" align="right" valign="top"><a id="a0127a0e28a6e25fd02f761bbe79a9b67" name="a0127a0e28a6e25fd02f761bbe79a9b67"></a>
std::map&lt; int, <a class="el" href="class_socket_state.html">SocketState</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>_socketStates</b></td></tr>
<tr class="separator:a0127a0e28a6e25fd02f761bbe79a9b67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb51072184b494e289eabc870324833c" id="r_aeb51072184b494e289eabc870324833c"><td class="memItemLeft" align="right" valign="top"><a id="aeb51072184b494e289eabc870324833c" name="aeb51072184b494e289eabc870324833c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>_servSockFd</b></td></tr>
<tr class="separator:aeb51072184b494e289eabc870324833c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad327f651b40df4c62c73b417e847669b" id="r_ad327f651b40df4c62c73b417e847669b"><td class="memItemLeft" align="right" valign="top"><a id="ad327f651b40df4c62c73b417e847669b" name="ad327f651b40df4c62c73b417e847669b"></a>
unsigned short&#160;</td><td class="memItemRight" valign="bottom"><b>_servPort</b></td></tr>
<tr class="separator:ad327f651b40df4c62c73b417e847669b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a919ae831a0f02a8f41970374ae6c2529" id="r_a919ae831a0f02a8f41970374ae6c2529"><td class="memItemLeft" align="right" valign="top"><a id="a919ae831a0f02a8f41970374ae6c2529" name="a919ae831a0f02a8f41970374ae6c2529"></a>
struct sockaddr_in&#160;</td><td class="memItemRight" valign="bottom"><b>_servAddr</b></td></tr>
<tr class="separator:a919ae831a0f02a8f41970374ae6c2529"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b821f1ea812c2e2d83d4aa0f3a888e0" id="r_a6b821f1ea812c2e2d83d4aa0f3a888e0"><td class="memItemLeft" align="right" valign="top"><a id="a6b821f1ea812c2e2d83d4aa0f3a888e0" name="a6b821f1ea812c2e2d83d4aa0f3a888e0"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>_response</b></td></tr>
<tr class="separator:a6b821f1ea812c2e2d83d4aa0f3a888e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a18b7f72724577a0fba37802fb36d8e7d" name="a18b7f72724577a0fba37802fb36d8e7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18b7f72724577a0fba37802fb36d8e7d">&#9670;&#160;</a></span>acceptNewConnection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::acceptNewConnection </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>serverIndex</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>新しいクライアント接続を受け入れます。 </p>
<p>サーバーソケットから新しいクライアントソケットを作成し、非ブロッキングモードに設定します。 また、クライアントソケットとリスニングポートのマッピングを行います。 poll()のためにサーバーと共用の_pollfds(vevtor)に追加します。</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">serverIndex</td><td>サーバーソケットのインデックス。 </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>接続の受け入れに失敗した場合に発生。 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>accept(): 新しいクライアントソケットを作成します <br  />
 </dd></dl>
<dl class="section see"><dt>See also</dt><dd><ul>
<li>参考:【Module ngx_http_core_module】 <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#keepalive_timeout">https://nginx.org/en/docs/http/ngx_http_core_module.html#keepalive_timeout</a></li>
<li>参考:【Mac OS X 開発者ツールのマニュアル ページ、setsockopt(2) 用】 <a href="https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man2/setsockopt.2.html">https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man2/setsockopt.2.html</a> </li>
</ul>
</dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a18b7f72724577a0fba37802fb36d8e7d_cgraph.png" border="0" usemap="#aclass_network_service_a18b7f72724577a0fba37802fb36d8e7d_cgraph" alt=""/></div>
<map name="aclass_network_service_a18b7f72724577a0fba37802fb36d8e7d_cgraph" id="aclass_network_service_a18b7f72724577a0fba37802fb36d8e7d_cgraph">
<area shape="rect" title="新しいクライアント接続を受け入れます。" alt="" coords="5,104,194,145"/>
<area shape="rect" href="class_network_service.html#a6fecddc50e233048c7e1632913dff0b5" title="新しいソケットを監視リストに追加します。" alt="" coords="249,5,434,46"/>
<area shape="poly" title=" " alt="" coords="142,101,241,57,260,49,262,54,243,61,144,106"/>
<area shape="rect" href="class_network_service.html#ae230dece0329581a121b72f4437e0518" title="クライアントの状態をもつクラスのインスタンスを作成し、配列に追加します。" alt="" coords="242,71,441,111"/>
<area shape="poly" title=" " alt="" coords="194,109,226,104,226,110,195,114"/>
<area shape="rect" href="class_network_service.html#a63bbb5ebfaed19591fb547b3f0cfffc5" title="クライアントソケットとリスニングポートのマッピングを設定します。" alt="" coords="251,136,432,177"/>
<area shape="poly" title=" " alt="" coords="195,134,235,140,235,145,194,139"/>
<area shape="rect" href="class_network_service.html#a34440b127df8820b685c1fd564b0a558" title="指定されたソケットをノンブロッキングモードに設定します。" alt="" coords="254,201,429,242"/>
<area shape="poly" title=" " alt="" coords="145,143,243,186,262,193,260,198,241,191,142,148"/>
<area shape="rect" href="class_port_mapping.html#af2565580060648e513ff1096677d5d83" title="指定されたサーバーソケットのリッスンポート番号を取得します。" alt="" coords="497,116,676,141"/>
<area shape="poly" title=" " alt="" coords="432,143,481,138,482,143,433,149"/>
<area shape="rect" href="class_port_mapping.html#a868fe44581e5fcc88863e86a890503cf" title="クライアントソケットとリッスンポートのマッピングを設定します。" alt="" coords="489,165,684,206"/>
<area shape="poly" title=" " alt="" coords="433,165,474,170,473,175,432,170"/>
<area shape="rect" href="class_port_mapping.html#a7988c74208b6c0ee10fe927ceac12490" title="指定されたキーに基づきポート番号をmapから取得します。std::map&lt;int, int&gt;型のmapに共通で使用します。" alt="" coords="732,116,932,141"/>
<area shape="poly" title=" " alt="" coords="677,126,717,126,717,131,677,131"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a18b7f72724577a0fba37802fb36d8e7d_icgraph.png" border="0" usemap="#aclass_network_service_a18b7f72724577a0fba37802fb36d8e7d_icgraph" alt=""/></div>
<map name="aclass_network_service_a18b7f72724577a0fba37802fb36d8e7d_icgraph" id="aclass_network_service_a18b7f72724577a0fba37802fb36d8e7d_icgraph">
<area shape="rect" title="新しいクライアント接続を受け入れます。" alt="" coords="501,5,689,46"/>
<area shape="rect" href="class_network_service.html#a79b80b9a51d73a85bb99b0ac0560a0c4" title="全てのサーバーsocket(port)でPOLLINフラグをチェックします" alt="" coords="255,5,453,46"/>
<area shape="poly" title=" " alt="" coords="485,28,454,28,454,23,485,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="a6fecddc50e233048c7e1632913dff0b5" name="a6fecddc50e233048c7e1632913dff0b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fecddc50e233048c7e1632913dff0b5">&#9670;&#160;</a></span>addSocketToPollFd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::addSocketToPollFd </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>socket</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; struct pollfd &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>fds</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>新しいソケットを監視リストに追加します。 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>追加するソケットのファイルディスクリプタ。 </td></tr>
    <tr><td class="paramname">fds</td><td>監視対象のソケットを保持するpollfd構造体のベクタ。（サーバーとクライアントで共用） </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><br  />
<ul>
<li>pollfdの管理: サーバーとクライアントを一つのvectorで管理します。</li>
<li>eventsの監視: POLLINとPOLLOUTの両方を監視します。</li>
<li>reventsの役割: POLLINとPOLLOUTのフラグが設定されます。このフラグを見て状態を判断します。 pollfd: 構造体で、監視対象のソケットとイベントタイプ（POLLIN=読み取り可能）を指定 <br  />
 struct pollfd { <br  />
 int fd; ファイル記述子 <br  />
 short events; 検索するイベント <br  />
 short revents; 返されたイベント <br  />
 }; <br  />
 POLLIN 読み出し可能なデータがある。 revents 要素は出力パラメータで、実際に起こったイベントがカーネルにより設定される。 </li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://ja.manpages.org/poll/2">https://ja.manpages.org/poll/2</a> </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a6fecddc50e233048c7e1632913dff0b5_icgraph.png" border="0" usemap="#aclass_network_service_a6fecddc50e233048c7e1632913dff0b5_icgraph" alt=""/></div>
<map name="aclass_network_service_a6fecddc50e233048c7e1632913dff0b5_icgraph" id="aclass_network_service_a6fecddc50e233048c7e1632913dff0b5_icgraph">
<area shape="rect" title="新しいソケットを監視リストに追加します。" alt="" coords="1002,39,1186,79"/>
<area shape="rect" href="class_network_service.html#a18b7f72724577a0fba37802fb36d8e7d" title="新しいクライアント接続を受け入れます。" alt="" coords="765,5,954,46"/>
<area shape="poly" title=" " alt="" coords="986,46,954,42,955,36,987,41"/>
<area shape="rect" href="class_network_service.html#a44006dbf443e41fff6a628d72e356dd3" title=".confのサーバーディレクティブの設定に基づいてセットアップを行います。" alt="" coords="767,71,952,111"/>
<area shape="poly" title=" " alt="" coords="987,76,953,81,952,76,986,71"/>
<area shape="rect" href="class_network_service.html#a79b80b9a51d73a85bb99b0ac0560a0c4" title="全てのサーバーsocket(port)でPOLLINフラグをチェックします" alt="" coords="266,7,464,47"/>
<area shape="poly" title=" " alt="" coords="750,29,464,29,464,24,750,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,45,207,71"/>
<area shape="poly" title=" " alt="" coords="251,43,207,48,207,43,250,38"/>
<area shape="rect" href="class_server_maneger.html#ab5e04aaf80feab4ba0522ab9311cf18f" title="設定ファイルを解析(parse)し、サーバーごとのポートでlistenを行い、pollfdを準備します。" alt="" coords="523,74,717,100"/>
<area shape="poly" title=" " alt="" coords="752,92,718,91,718,86,752,87"/>
<area shape="rect" href="class_server_maneger.html#a104f42d342bf9d6af9c45c200d22facd" title="サーバーのループを再起動します。" alt="" coords="255,73,475,99"/>
<area shape="poly" title=" " alt="" coords="507,89,476,89,476,84,507,84"/>
<area shape="poly" title=" " alt="" coords="239,75,207,71,207,66,239,69"/>
</map>
</div>

</div>
</div>
<a id="a76eb3eb24ee923721a827e11d5bf7234" name="a76eb3eb24ee923721a827e11d5bf7234"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76eb3eb24ee923721a827e11d5bf7234">&#9670;&#160;</a></span>bindAddr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::bindAddr </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>サーバーソケットにアドレスをバインドします。 </p>
<p>ソケットにsockaddr構造体を指定してbind()を呼び出します。 <br  />
 bind()はソケットにIPアドレスとポート番号を関連付けます。 失敗した場合はリトライすることができます。 </p><dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>bind()の呼び出しに失敗した場合に発生。　　 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>失敗したらwaitSec時間待機して再度bind()を行います。最大retryMax回行います。</li>
<li>テスト中によく起きるので特別にケアしました。原因：osがportを解放するまで時間がかかるため ※テスト時のport解放方法: lsof -i :80でpidを確認し、kill SIGINT "pid番号" で解放してください。 </li>
</ul>
</dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a76eb3eb24ee923721a827e11d5bf7234_icgraph.png" border="0" usemap="#aclass_network_service_a76eb3eb24ee923721a827e11d5bf7234_icgraph" alt=""/></div>
<map name="aclass_network_service_a76eb3eb24ee923721a827e11d5bf7234_icgraph" id="aclass_network_service_a76eb3eb24ee923721a827e11d5bf7234_icgraph">
<area shape="rect" title="サーバーソケットにアドレスをバインドします。" alt="" coords="998,13,1171,39"/>
<area shape="rect" href="class_network_service.html#a44006dbf443e41fff6a628d72e356dd3" title=".confのサーバーディレクティブの設定に基づいてセットアップを行います。" alt="" coords="765,5,950,46"/>
<area shape="poly" title=" " alt="" coords="983,28,950,28,950,23,983,23"/>
<area shape="rect" href="class_server_maneger.html#ab5e04aaf80feab4ba0522ab9311cf18f" title="設定ファイルを解析(parse)し、サーバーごとのポートでlistenを行い、pollfdを準備します。" alt="" coords="523,13,717,39"/>
<area shape="poly" title=" " alt="" coords="750,28,718,28,718,23,750,23"/>
<area shape="rect" href="class_server_maneger.html#a104f42d342bf9d6af9c45c200d22facd" title="サーバーのループを再起動します。" alt="" coords="255,13,475,39"/>
<area shape="poly" title=" " alt="" coords="507,28,476,28,476,23,507,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="a16ed9bd4de8e026601eca26611647507" name="a16ed9bd4de8e026601eca26611647507"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16ed9bd4de8e026601eca26611647507">&#9670;&#160;</a></span>closeAndCleanupSocket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::closeAndCleanupSocket </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; struct pollfd &gt;::iterator &amp;</td>          <td class="paramname"><span class="paramname"><em>it</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ソケットを閉じ、関連するリソースをクリーンアップします。 </p>
<p>この関数は指定されたソケットを閉じ、ソケットに関連付けられた状態情報をクリアし、 監視リストから該当するpollfd構造体を削除します。これにより、ソケットと それに関連するリソースが適切に解放されます。</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">it</td><td>クリーンアップ対象のソケットを指すpollfdベクターのイテレータ。 </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a16ed9bd4de8e026601eca26611647507_cgraph.png" border="0" usemap="#aclass_network_service_a16ed9bd4de8e026601eca26611647507_cgraph" alt=""/></div>
<map name="aclass_network_service_a16ed9bd4de8e026601eca26611647507_cgraph" id="aclass_network_service_a16ed9bd4de8e026601eca26611647507_cgraph">
<area shape="rect" title="ソケットを閉じ、関連するリソースをクリーンアップします。" alt="" coords="5,5,182,46"/>
<area shape="rect" href="class_network_service.html#a648626623792dd4752c1daaffe876ffc" title="指定されたソケットの接続を閉じます。" alt="" coords="230,13,449,39"/>
<area shape="poly" title=" " alt="" coords="182,23,214,23,214,28,182,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a16ed9bd4de8e026601eca26611647507_icgraph.png" border="0" usemap="#aclass_network_service_a16ed9bd4de8e026601eca26611647507_icgraph" alt=""/></div>
<map name="aclass_network_service_a16ed9bd4de8e026601eca26611647507_icgraph" id="aclass_network_service_a16ed9bd4de8e026601eca26611647507_icgraph">
<area shape="rect" title="ソケットを閉じ、関連するリソースをクリーンアップします。" alt="" coords="494,39,670,79"/>
<area shape="rect" href="class_network_service.html#afc2ce78b98367413538d7d84537b867e" title="すべてのクライアントソケットからのリクエストを処理します。" alt="" coords="255,5,446,46"/>
<area shape="poly" title=" " alt="" coords="478,47,446,42,447,37,479,41"/>
<area shape="rect" href="class_network_service.html#a8849b9c719cb649dbbbae76d9981da7c" title="クライアントへの応答を処理します。" alt="" coords="255,71,446,111"/>
<area shape="poly" title=" " alt="" coords="479,76,446,80,446,75,478,71"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,46,207,72"/>
<area shape="poly" title=" " alt="" coords="240,43,205,48,205,43,239,38"/>
<area shape="poly" title=" " alt="" coords="239,79,207,75,208,70,240,74"/>
</map>
</div>

</div>
</div>
<a id="a648626623792dd4752c1daaffe876ffc" name="a648626623792dd4752c1daaffe876ffc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a648626623792dd4752c1daaffe876ffc">&#9670;&#160;</a></span>closeConnection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::closeConnection </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>socketFd</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>指定されたソケットの接続を閉じます。 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socketFd</td><td>閉じるソケットのファイルディスクリプタ。 </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>socketFdが無効、またはclose()が失敗した場合に発生。 </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a648626623792dd4752c1daaffe876ffc_icgraph.png" border="0" usemap="#aclass_network_service_a648626623792dd4752c1daaffe876ffc_icgraph" alt=""/></div>
<map name="aclass_network_service_a648626623792dd4752c1daaffe876ffc_icgraph" id="aclass_network_service_a648626623792dd4752c1daaffe876ffc_icgraph">
<area shape="rect" title="指定されたソケットの接続を閉じます。" alt="" coords="718,46,938,72"/>
<area shape="rect" href="class_network_service.html#a16ed9bd4de8e026601eca26611647507" title="ソケットを閉じ、関連するリソースをクリーンアップします。" alt="" coords="494,39,670,79"/>
<area shape="poly" title=" " alt="" coords="703,62,671,62,671,56,703,56"/>
<area shape="rect" href="class_network_service.html#afc2ce78b98367413538d7d84537b867e" title="すべてのクライアントソケットからのリクエストを処理します。" alt="" coords="255,5,446,46"/>
<area shape="poly" title=" " alt="" coords="478,47,446,42,447,37,479,41"/>
<area shape="rect" href="class_network_service.html#a8849b9c719cb649dbbbae76d9981da7c" title="クライアントへの応答を処理します。" alt="" coords="255,71,446,111"/>
<area shape="poly" title=" " alt="" coords="479,76,446,80,446,75,478,71"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,46,207,72"/>
<area shape="poly" title=" " alt="" coords="240,43,205,48,205,43,239,38"/>
<area shape="poly" title=" " alt="" coords="239,79,207,75,208,70,240,74"/>
</map>
</div>

</div>
</div>
<a id="abb307c95e97d912803bff29f67f533ca" name="abb307c95e97d912803bff29f67f533ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb307c95e97d912803bff29f67f533ca">&#9670;&#160;</a></span>configureServerAddress()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::configureServerAddress </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>サーバーアドレスを設定します。 </p>
<p>sockaddr_in構造体を使用してサーバーアドレスを設定します。 AF_INETとINADDR_ANYを用いてIPv4アドレスを指定し、指定されたポート番号でバインドします。 </p><dl class="section note"><dt>Note</dt><dd><div class="fragment"><div class="line">AF_INET:IPv4アドレスの使用  </div>
<div class="line">INADDR_ANY:任意のアドレスで受付  </div>
<div class="line">htons:バイトオーダーをビッグエンディアン(最上位バイトが先)へ変更  </div>
</div><!-- fragment --> </dd>
<dd>
<br  />
<ul>
<li>struct sockaddr_in について<ul>
<li>sockAddrの後半8バイトを使わないのがsockAddr_in。Cスタイルでもキャスト可能。 </li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd>参考:【sockaddr(3type) - Linux manual page】 <a href="https://man7.org/linux/man-pages/man3/sockaddr.3type.html">https://man7.org/linux/man-pages/man3/sockaddr.3type.html</a> </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_abb307c95e97d912803bff29f67f533ca_icgraph.png" border="0" usemap="#aclass_network_service_abb307c95e97d912803bff29f67f533ca_icgraph" alt=""/></div>
<map name="aclass_network_service_abb307c95e97d912803bff29f67f533ca_icgraph" id="aclass_network_service_abb307c95e97d912803bff29f67f533ca_icgraph">
<area shape="rect" title="サーバーアドレスを設定します。" alt="" coords="998,5,1173,46"/>
<area shape="rect" href="class_network_service.html#a44006dbf443e41fff6a628d72e356dd3" title=".confのサーバーディレクティブの設定に基づいてセットアップを行います。" alt="" coords="765,5,950,46"/>
<area shape="poly" title=" " alt="" coords="983,28,950,28,950,23,983,23"/>
<area shape="rect" href="class_server_maneger.html#ab5e04aaf80feab4ba0522ab9311cf18f" title="設定ファイルを解析(parse)し、サーバーごとのポートでlistenを行い、pollfdを準備します。" alt="" coords="523,13,717,39"/>
<area shape="poly" title=" " alt="" coords="750,28,718,28,718,23,750,23"/>
<area shape="rect" href="class_server_maneger.html#a104f42d342bf9d6af9c45c200d22facd" title="サーバーのループを再起動します。" alt="" coords="255,13,475,39"/>
<area shape="poly" title=" " alt="" coords="507,28,476,28,476,23,507,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="acf04155926d7461e63432034869d23b7" name="acf04155926d7461e63432034869d23b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf04155926d7461e63432034869d23b7">&#9670;&#160;</a></span>createServerSocket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::createServerSocket </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>サーバーソケットを作成します。 </p>
<p>socket()関数を使用してサーバーソケットを作成し、setsockopt()を使ってSO_REUSEADDRオプションを設定します。 これにより、同じポートを再利用可能にします。 </p><dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>ソケット作成またはオプション設定に失敗した場合に発生。 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><div class="fragment"><div class="line">- TCPソケット:接続指向（接続後に通信）のサービス。OSIのトランスポート層に相当。  </div>
<div class="line">- PF_INET:IPv4インターネットプロトコル  </div>
<div class="line">- SOCK_STREAM:順序付けられた、双方向のバイトストリームを提供するTCPソケットを指定。フロー制御、輻輳（ふくそう）制御、接続の確立と終了  </div>
<div class="line">- IPPROTO_TCP:TCPプロトコルを明示的に指定。</div>
</div><!-- fragment --> </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_acf04155926d7461e63432034869d23b7_icgraph.png" border="0" usemap="#aclass_network_service_acf04155926d7461e63432034869d23b7_icgraph" alt=""/></div>
<map name="aclass_network_service_acf04155926d7461e63432034869d23b7_icgraph" id="aclass_network_service_acf04155926d7461e63432034869d23b7_icgraph">
<area shape="rect" title="サーバーソケットを作成します。" alt="" coords="998,5,1194,46"/>
<area shape="rect" href="class_network_service.html#a44006dbf443e41fff6a628d72e356dd3" title=".confのサーバーディレクティブの設定に基づいてセットアップを行います。" alt="" coords="765,5,950,46"/>
<area shape="poly" title=" " alt="" coords="982,28,950,28,950,23,982,23"/>
<area shape="rect" href="class_server_maneger.html#ab5e04aaf80feab4ba0522ab9311cf18f" title="設定ファイルを解析(parse)し、サーバーごとのポートでlistenを行い、pollfdを準備します。" alt="" coords="523,13,717,39"/>
<area shape="poly" title=" " alt="" coords="750,28,718,28,718,23,750,23"/>
<area shape="rect" href="class_server_maneger.html#a104f42d342bf9d6af9c45c200d22facd" title="サーバーのループを再起動します。" alt="" coords="255,13,475,39"/>
<area shape="poly" title=" " alt="" coords="507,28,476,28,476,23,507,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="ae230dece0329581a121b72f4437e0518" name="ae230dece0329581a121b72f4437e0518"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae230dece0329581a121b72f4437e0518">&#9670;&#160;</a></span>createSocketState()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::createSocketState </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>serverIndex</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>clientSocket</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>クライアントの状態をもつクラスのインスタンスを作成し、配列に追加します。 </p>
<p>すでに存在する場合は、一旦削除されて新規追加されます。</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">serverIndex</td><td><code>_serverDirectives</code>配列内の<code><a class="el" href="class_server_directive.html">ServerDirective</a></code>オブジェクトのインデックス。 </td></tr>
    <tr><td class="paramname">clientSocket</td><td>クライアントのソケットFD。<code><a class="el" href="class_socket_state.html">SocketState</a></code>オブジェクトのキーとして使用され、マップ内で一意に識別します </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_ae230dece0329581a121b72f4437e0518_icgraph.png" border="0" usemap="#aclass_network_service_ae230dece0329581a121b72f4437e0518_icgraph" alt=""/></div>
<map name="aclass_network_service_ae230dece0329581a121b72f4437e0518_icgraph" id="aclass_network_service_ae230dece0329581a121b72f4437e0518_icgraph">
<area shape="rect" title="クライアントの状態をもつクラスのインスタンスを作成し、配列に追加します。" alt="" coords="737,5,937,46"/>
<area shape="rect" href="class_network_service.html#a18b7f72724577a0fba37802fb36d8e7d" title="新しいクライアント接続を受け入れます。" alt="" coords="501,5,689,46"/>
<area shape="poly" title=" " alt="" coords="722,28,690,28,690,23,722,23"/>
<area shape="rect" href="class_network_service.html#a79b80b9a51d73a85bb99b0ac0560a0c4" title="全てのサーバーsocket(port)でPOLLINフラグをチェックします" alt="" coords="255,5,453,46"/>
<area shape="poly" title=" " alt="" coords="485,28,454,28,454,23,485,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="a1b6605ad0ddb71f1fc7a87ff616cf872" name="a1b6605ad0ddb71f1fc7a87ff616cf872"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b6605ad0ddb71f1fc7a87ff616cf872">&#9670;&#160;</a></span>executeClientHttpSession()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::executeClientHttpSession </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>socketFd</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>クライアントのHTTPセッションを実行します。 </p>
<p>この関数はクライアントの完全なHTTPセッションを処理します。ソケットからデータを受信し、 HTTPリクエストを処理し、適切なレスポンスを作成までを行います。 ※send()は別のloopでPOLLOUTを確認してから行います。</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socketFd</td><td>クライアントソケットのファイルディスクリプタ。</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd></dd></dl>
<h1><a class="anchor" id="autotoc_md4"></a>
流れ</h1>
<ul>
<li>過去のデータの取得: ソケットの前回の情報 socketState を取得</li>
<li>今回のデータ用に格納: 今回の通信に必要な情報をまとめたところ httpTransaction に格納　 <br  />
</li>
<li>メソッドを実行: その情報を持たせて、処理 httpWorkflowManager を実行 <br  />
 </li>
</ul>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a1b6605ad0ddb71f1fc7a87ff616cf872_cgraph.png" border="0" usemap="#aclass_network_service_a1b6605ad0ddb71f1fc7a87ff616cf872_cgraph" alt=""/></div>
<map name="aclass_network_service_a1b6605ad0ddb71f1fc7a87ff616cf872_cgraph" id="aclass_network_service_a1b6605ad0ddb71f1fc7a87ff616cf872_cgraph">
<area shape="rect" title="クライアントのHTTPセッションを実行します。" alt="" coords="5,612,208,653"/>
<area shape="rect" href="class_http_workflow_manager.html#a09d2f69d56764717d9c9f65192ab6737" title="HTTPトランザクションの状態に応じたハンドラを実行します。" alt="" coords="256,612,440,653"/>
<area shape="poly" title=" " alt="" coords="208,630,240,630,240,635,208,635"/>
<area shape="rect" href="class_response_str_build_state.html#a983867825b18ab9d9f98ef5b43117a69" title="レスポンスボディを構築します。" alt="" coords="752,468,910,509"/>
<area shape="poly" title=" " alt="" coords="365,609,416,560,450,535,487,515,550,495,615,484,679,479,737,479,737,484,679,485,616,489,551,501,489,520,453,539,419,564,369,613"/>
<area shape="rect" href="class_response_str_build_state.html#ad33030a4db24275b7349a8b0753ba6e9" title="レスポンスヘッダを構築します。" alt="" coords="752,547,910,587"/>
<area shape="poly" title=" " alt="" coords="371,609,421,572,453,554,487,540,551,528,617,526,680,531,737,541,736,546,680,537,617,532,552,534,489,546,456,559,424,576,374,614"/>
<area shape="rect" href="class_response_str_build_state.html#a2d6e42fa92fd6a33658379e997d77c2e" title="レスポンスのステータスライン(1行目)を構築します。" alt="" coords="742,612,920,653"/>
<area shape="poly" title=" " alt="" coords="440,630,727,630,727,635,440,635"/>
<area shape="rect" href="class_http_workflow_manager.html#a0014db595ae6547c54ab46f4f3901ea9" title="有効なファイルパスを探索します。" alt="" coords="499,669,649,710"/>
<area shape="poly" title=" " alt="" coords="431,651,485,664,483,669,430,656"/>
<area shape="rect" href="class_cgi_execution_state.html#aecf27444a140a66641a2b9a35327fca5" title="CGIが必要である場合にCGIスクリプト実行処理を行います。" alt="" coords="505,263,643,303"/>
<area shape="poly" title=" " alt="" coords="356,610,407,507,444,441,486,376,539,313,543,316,490,379,449,444,412,510,361,613"/>
<area shape="rect" href="class_content_extraction_state.html#a127f220bca1ccb5923933c272c6cefe0" title="HTTPリクエストに基づいてコンテンツ抽出処理を実行します。" alt="" coords="496,389,653,430"/>
<area shape="poly" title=" " alt="" coords="358,610,407,532,444,487,486,446,502,435,505,440,490,450,448,490,412,535,363,613"/>
<area shape="rect" href="class_file_path_generation_state.html#a4ee6c300ff2d365526e49a3a32cf0f11" title="HTTPリクエストに基づいてファイルパス生成処理を実行します。" alt="" coords="493,735,656,775"/>
<area shape="poly" title=" " alt="" coords="379,651,430,685,489,719,502,726,500,730,487,724,427,689,376,655"/>
<area shape="rect" href="class_header_parser_stream.html#a231d52a867b447e6cc8ebbe415d855bb" title="データを逐次的に読み取りながら解析します。" alt="" coords="503,800,646,841"/>
<area shape="poly" title=" " alt="" coords="365,652,416,716,450,753,490,785,498,790,495,795,486,789,447,757,412,720,361,655"/>
<area shape="rect" href="class_identify_location_state.html#aa290323ea9d092dfced1ecef61f21a4c" title="クライアントのリクエストURIに基づいて適切なサーバーとロケーションを識別しセットします。" alt="" coords="502,865,646,906"/>
<area shape="poly" title=" " alt="" coords="359,652,377,693,406,746,443,802,490,850,496,855,493,859,486,854,439,805,401,749,373,695,355,654"/>
<area shape="rect" href="class_parsing_body_state.html#a84c05e6122297eb58e0863755934ba79" title="HTTPリクエストの解析を行います。" alt="" coords="488,970,660,996"/>
<area shape="poly" title=" " alt="" coords="358,652,376,702,404,771,442,845,490,916,513,940,539,959,536,963,510,944,486,919,438,848,399,773,371,704,353,654"/>
<area shape="rect" href="class_response_str_build_state.html#aab058472aeb563041e918bed4c5c3b17" title="クライアントにsend()するレスポンスメッセージを構築します。" alt="" coords="496,555,653,595"/>
<area shape="poly" title=" " alt="" coords="430,609,480,596,481,601,431,614"/>
<area shape="rect" href="class_util_http_processing_step.html#a21282f874e910a6bbb63719d6199efe6" title="404や500など、ステータスコードに対応するエラーページの内容を返します。" alt="" coords="1038,497,1197,538"/>
<area shape="poly" title=" " alt="" coords="910,494,1023,505,1022,511,910,499"/>
<area shape="rect" href="class_util_http_processing_step.html#ab9931d09caf710018e021acf13e11e93" title="レスポンスボディを設定し、その長さに基づいてレスポンスのContent&#45;Lengthヘッダーを設定します。" alt="" coords="1317,389,1475,430"/>
<area shape="poly" title=" " alt="" coords="910,475,1301,420,1302,425,910,480"/>
<area shape="rect" href="class_response_str_build_state.html#a02838bcf03951383fff1f024c91bc109" title=" " alt="" coords="1002,563,1233,603"/>
<area shape="poly" title=" " alt="" coords="910,569,986,573,986,578,910,574"/>
<area shape="rect" href="class_cgi_execution_state.html#ac2ce6937814bad9d326cb72e28457bdd" title="CGIスクリプトを子プロセスで実行します。" alt="" coords="726,201,936,242"/>
<area shape="poly" title=" " alt="" coords="643,264,728,244,729,249,645,269"/>
<area shape="rect" href="class_cgi_execution_state.html#aaa36c8ac603138c4b2541ecb5e6c135a" title="環境変数をstd::stringからchar*に変換します。" alt="" coords="1037,5,1198,46"/>
<area shape="poly" title=" " alt="" coords="846,199,909,129,952,90,1000,57,1022,46,1024,51,1003,61,955,95,912,133,850,203"/>
<area shape="rect" href="class_cgi_execution_state.html#a3640636e5ea7f26c87481c7e0e1bab69" title="パイプを作成し、新しいプロセスをフォークします。" alt="" coords="1048,201,1187,242"/>
<area shape="poly" title=" " alt="" coords="937,219,1032,219,1032,224,937,224"/>
<area shape="rect" href="class_cgi_execution_state.html#af7a2830b1943e93db5a6e57ad1711498" title="CGIスクリプトを実行します。" alt="" coords="1048,267,1187,307"/>
<area shape="poly" title=" " alt="" coords="924,240,1033,265,1032,270,923,245"/>
<area shape="rect" href="class_cgi_execution_state.html#aff9df70d227ed984a62c5f44c284b116" title="CGIスクリプト実行の親プロセスの処理を実行します。" alt="" coords="1045,136,1190,177"/>
<area shape="poly" title=" " alt="" coords="923,198,1029,174,1030,179,924,203"/>
<area shape="rect" href="class_cgi_execution_state.html#a0a3236dd76cf8bd5a8115a348a296481" title="CGIプロセスのファイルディスクリプタをセットアップします。" alt="" coords="1013,332,1222,373"/>
<area shape="poly" title=" " alt="" coords="864,240,927,278,1003,317,1022,324,1020,329,1001,321,924,283,862,245"/>
<area shape="rect" href="class_cgi_execution_state.html#ad69e96a830c5ade8aa774703694a4413" title="CGIスクリプトの実行環境をstd::string型のvectorでセットアップします。" alt="" coords="1028,71,1207,111"/>
<area shape="poly" title=" " alt="" coords="862,199,924,160,1001,122,1020,114,1022,119,1003,127,927,165,864,203"/>
<area shape="poly" title=" " alt="" coords="1191,167,1234,187,1284,231,1325,281,1357,331,1381,374,1376,377,1353,334,1320,284,1280,234,1232,192,1189,172"/>
<area shape="rect" href="class_cgi_execution_state.html#a87dd9281aa48ff54b9c767bc58007601" title="フォークされたプロセスの終了を非ブロッキングで待ちます。" alt="" coords="1327,136,1465,177"/>
<area shape="poly" title=" " alt="" coords="1190,154,1311,154,1311,159,1190,159"/>
<area shape="rect" href="class_cgi_execution_state.html#a0ea4850cd9670c360522e59d4315b88f" title="環境変数の文字列を結合して作成し、vectorに追加します" alt="" coords="1281,71,1510,111"/>
<area shape="poly" title=" " alt="" coords="1207,88,1266,88,1266,94,1207,94"/>
<area shape="rect" href="class_content_extraction_state.html#a565b31e0c01130f683c56168e772a12d" title="ファイルの内容をHTTPレスポンスボディに読み込みます。" alt="" coords="719,389,943,430"/>
<area shape="poly" title=" " alt="" coords="653,407,704,407,704,412,653,412"/>
<area shape="poly" title=" " alt="" coords="944,407,1301,407,1301,412,944,412"/>
<area shape="rect" href="class_header_parser_stream.html#a976623c54d7466c2e0b36bc2187f7479" title="ソケットからメッセージを受信します。" alt="" coords="759,783,903,823"/>
<area shape="poly" title=" " alt="" coords="646,813,743,806,744,812,646,818"/>
<area shape="rect" href="class_header_parser_stream.html#a4fb1ebe642377978c9ca699401f1c85a" title="受信したHTTPリクエストヘッダーを解析します。" alt="" coords="1038,832,1197,873"/>
<area shape="poly" title=" " alt="" coords="904,813,1022,833,1022,839,903,818"/>
<area shape="rect" href="class_header_parser_stream.html#aca8853f3ffd75cb79e8ab68d965d48c4" title="HTTPリクエストボディを受信します。" alt="" coords="1042,767,1193,807"/>
<area shape="poly" title=" " alt="" coords="903,796,1027,789,1027,795,903,802"/>
<area shape="rect" href="class_header_parser_stream.html#adade1c979989d5670bc8759c6318dd2a" title="受信したデータをベクターに追加します。" alt="" coords="1316,709,1475,750"/>
<area shape="poly" title=" " alt="" coords="894,779,946,765,1001,752,1080,741,1159,734,1300,727,1301,733,1159,739,1080,747,1002,758,947,770,895,785"/>
<area shape="rect" href="class_header_parser_stream.html#adf1b4d67ca01d835bf3fd4102ec6e608" title="HTTPリクエストヘッダーを解析します。" alt="" coords="1320,840,1472,881"/>
<area shape="poly" title=" " alt="" coords="1198,852,1304,855,1304,860,1198,857"/>
<area shape="rect" href="class_header_parser_stream.html#a0a4d53d99544647884a82e0cc2203936" title="HTTPリクエストラインを解析します。" alt="" coords="1324,775,1467,815"/>
<area shape="poly" title=" " alt="" coords="1197,833,1308,810,1309,815,1198,839"/>
<area shape="rect" href="class_header_parser_stream.html#ac07c7ad79d2dc56ce06eb41e5cbf5235" title="特定のHTTPヘッダーを処理し、関連する情報を格納します。" alt="" coords="1558,840,1718,881"/>
<area shape="poly" title=" " alt="" coords="1472,858,1543,858,1543,863,1472,863"/>
<area shape="poly" title=" " alt="" coords="1192,769,1300,747,1301,752,1193,774"/>
<area shape="rect" href="class_identify_location_state.html#a5c4f6cc671ed7dad98dd5fa58feae69c" title="クライアントのリクエストURIに基づいて適切な LocationDirective を識別します。" alt="" coords="720,865,942,906"/>
<area shape="poly" title=" " alt="" coords="647,883,705,883,705,888,647,888"/>
<area shape="rect" href="class_identify_location_state.html#a617243d028b31872ffbe3719c39abf27" title="一致する LocationDirective を見つけます。" alt="" coords="1015,901,1220,942"/>
<area shape="poly" title=" " alt="" coords="942,897,1000,904,999,910,942,902"/>
<area shape="rect" href="class_identify_location_state.html#a76736f8586e16547bfe15a23f03f887e" title="URIパターンがロケーションディレクティブに一致するかを判断します。" alt="" coords="1323,905,1468,946"/>
<area shape="poly" title=" " alt="" coords="1220,920,1307,922,1307,927,1220,926"/>
<area shape="rect" href="class_parsing_body_state.html#a0f773ef745b2d1d6926a02a14be8623f" title="リクエストURIから拡張子を抽出します。" alt="" coords="727,931,935,971"/>
<area shape="poly" title=" " alt="" coords="661,970,711,963,712,969,661,975"/>
<area shape="rect" href="class_parsing_body_state.html#a869dc59d24bb341260124ce9b9a31f24" title="URIから&quot;.cgi&quot;が存在する場合、その後に続くpathinfoとクエリ文字列を抽出します" alt="" coords="733,996,929,1037"/>
<area shape="poly" title=" " alt="" coords="661,992,718,999,717,1004,660,997"/>
<area shape="rect" href="class_parsing_body_state.html#ac4e24d9a1e9f5cc6ba348340f2c3eb58" title="HTTPリクエストボディを解析します。" alt="" coords="708,1061,954,1087"/>
<area shape="poly" title=" " alt="" coords="600,994,649,1020,709,1046,737,1054,736,1059,707,1051,647,1025,597,999"/>
<area shape="rect" href="class_parsing_body_state.html#a038ea446c8c7688dfd53af4afd944c9d" title=" " alt="" coords="1031,1020,1204,1061"/>
<area shape="poly" title=" " alt="" coords="947,1058,1015,1049,1016,1055,947,1063"/>
<area shape="rect" href="class_parsing_body_state.html#a85a43d44071d51ee96dd501ccc850d59" title="チャンクエンコーディングの際のリクエストボディを解析します" alt="" coords="1031,1085,1204,1126"/>
<area shape="poly" title=" " alt="" coords="952,1084,1016,1092,1015,1097,952,1090"/>
<area shape="poly" title=" " alt="" coords="636,551,753,512,755,517,638,557"/>
<area shape="poly" title=" " alt="" coords="653,570,736,567,737,573,654,575"/>
<area shape="poly" title=" " alt="" coords="654,590,728,607,727,612,653,595"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a1b6605ad0ddb71f1fc7a87ff616cf872_icgraph.png" border="0" usemap="#aclass_network_service_a1b6605ad0ddb71f1fc7a87ff616cf872_icgraph" alt=""/></div>
<map name="aclass_network_service_a1b6605ad0ddb71f1fc7a87ff616cf872_icgraph" id="aclass_network_service_a1b6605ad0ddb71f1fc7a87ff616cf872_icgraph">
<area shape="rect" title="クライアントのHTTPセッションを実行します。" alt="" coords="494,5,696,46"/>
<area shape="rect" href="class_network_service.html#afc2ce78b98367413538d7d84537b867e" title="すべてのクライアントソケットからのリクエストを処理します。" alt="" coords="255,5,446,46"/>
<area shape="poly" title=" " alt="" coords="478,28,446,28,446,23,478,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="a79b34078f8a4e6c978ab8fae8e4769db" name="a79b34078f8a4e6c978ab8fae8e4769db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79b34078f8a4e6c978ab8fae8e4769db">&#9670;&#160;</a></span>handlePoll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PollAction NetworkService::handlePoll </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; struct pollfd &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>fds</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>poll()を使用してファイルディスクリプタのイベントを待ちます。 </p>
<dl class="section note"><dt>Note</dt><dd>timeout引数は、ファイルディスクリプタが利用可能になるまでpoll()が停止する時間をミリ秒で指定します。 poll()の呼び出しは以下のいずれかになるまで停止します:<ul>
<li>ファイルディスクリプタが利用可能になる</li>
<li>呼び出しがシグナルハンドラーにより割り込まれる</li>
<li>タイムアウトが満了する <div class="fragment"><div class="line"><span class="keyword">struct </span>pollfd {</div>
<div class="line">    <span class="keywordtype">int</span>     fd;</div>
<div class="line">    <span class="keywordtype">short</span>   events;</div>
<div class="line">    <span class="keywordtype">short</span>   revents;</div>
<div class="line">};</div>
</div><!-- fragment --> </li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://manpages.ubuntu.com/manpages/focal/ja/man2/poll.2.html">https://manpages.ubuntu.com/manpages/focal/ja/man2/poll.2.html</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fds</td><td>イベントを監視するファイルディスクリプタのベクタ </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PollAction POLL_WITH_EVENT, POLL_NO_EVENT, またはエラー時には例外を投げます。 </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>不正なファイルディスクリプタが存在する場合に発生します。 </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a79b34078f8a4e6c978ab8fae8e4769db_icgraph.png" border="0" usemap="#aclass_network_service_a79b34078f8a4e6c978ab8fae8e4769db_icgraph" alt=""/></div>
<map name="aclass_network_service_a79b34078f8a4e6c978ab8fae8e4769db_icgraph" id="aclass_network_service_a79b34078f8a4e6c978ab8fae8e4769db_icgraph">
<area shape="rect" title="poll()を使用してファイルディスクリプタのイベントを待ちます。" alt="" coords="255,5,437,31"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,5,207,31"/>
<area shape="poly" title=" " alt="" coords="239,21,207,21,207,16,239,16"/>
</map>
</div>

</div>
</div>
<a id="afc2ce78b98367413538d7d84537b867e" name="afc2ce78b98367413538d7d84537b867e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc2ce78b98367413538d7d84537b867e">&#9670;&#160;</a></span>handleRecvRequests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::handleRecvRequests </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>すべてのクライアントソケットからのリクエストを処理します。 </p>
<p>この関数は、pollセットにあるすべてのクライアントファイルディスクリプタを反復処理し、POLLINイベントが設定されたソケットからのリクエストを読み込んで、std::map&lt;int, SocketState&gt;&amp;_socketStates;に格納します。 </p><dl class="section note"><dt>Note</dt><dd>エラーの許容最大数を超えた場合はサーバーをリセットするためにthrowします。 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_afc2ce78b98367413538d7d84537b867e_cgraph.png" border="0" usemap="#aclass_network_service_afc2ce78b98367413538d7d84537b867e_cgraph" alt=""/></div>
<map name="aclass_network_service_afc2ce78b98367413538d7d84537b867e_cgraph" id="aclass_network_service_afc2ce78b98367413538d7d84537b867e_cgraph">
<area shape="rect" title="すべてのクライアントソケットからのリクエストを処理します。" alt="" coords="5,612,197,653"/>
<area shape="rect" href="class_network_service.html#a16ed9bd4de8e026601eca26611647507" title="ソケットを閉じ、関連するリソースをクリーンアップします。" alt="" coords="258,547,434,587"/>
<area shape="poly" title=" " alt="" coords="179,609,252,589,253,594,181,614"/>
<area shape="rect" href="class_network_service.html#a1b6605ad0ddb71f1fc7a87ff616cf872" title="クライアントのHTTPセッションを実行します。" alt="" coords="245,612,447,653"/>
<area shape="poly" title=" " alt="" coords="197,630,229,630,229,635,197,635"/>
<area shape="rect" href="class_network_service.html#a7101de80b1b3b348f2012246c598b0e4" title="引数のイテレータがサーバーソケットを指しているかどうかを判断します。" alt="" coords="253,677,439,703"/>
<area shape="poly" title=" " alt="" coords="191,651,273,670,272,675,190,656"/>
<area shape="rect" href="class_network_service.html#a648626623792dd4752c1daaffe876ffc" title="指定されたソケットの接続を閉じます。" alt="" coords="495,554,714,580"/>
<area shape="poly" title=" " alt="" coords="435,564,479,564,479,570,435,570"/>
<area shape="rect" href="class_http_workflow_manager.html#a09d2f69d56764717d9c9f65192ab6737" title="HTTPトランザクションの状態に応じたハンドラを実行します。" alt="" coords="513,612,697,653"/>
<area shape="poly" title=" " alt="" coords="447,630,497,630,497,635,447,635"/>
<area shape="rect" href="class_response_str_build_state.html#a983867825b18ab9d9f98ef5b43117a69" title="レスポンスボディを構築します。" alt="" coords="1027,468,1184,509"/>
<area shape="poly" title=" " alt="" coords="681,609,713,590,728,571,735,551,742,531,761,513,790,498,822,486,887,472,952,469,1011,471,1011,477,952,474,888,478,823,491,792,502,764,517,747,534,740,553,733,574,716,594,684,614"/>
<area shape="rect" href="class_response_str_build_state.html#ad33030a4db24275b7349a8b0753ba6e9" title="レスポンスヘッダを構築します。" alt="" coords="1027,547,1184,587"/>
<area shape="poly" title=" " alt="" coords="675,609,713,590,727,578,735,564,745,551,761,541,795,529,829,522,900,519,968,527,1027,540,1026,545,967,532,900,525,830,528,796,534,764,545,748,555,740,567,731,581,716,595,678,614"/>
<area shape="rect" href="class_response_str_build_state.html#a2d6e42fa92fd6a33658379e997d77c2e" title="レスポンスのステータスライン(1行目)を構築します。" alt="" coords="1017,612,1194,653"/>
<area shape="poly" title=" " alt="" coords="697,630,1001,630,1001,635,697,635"/>
<area shape="rect" href="class_http_workflow_manager.html#a0014db595ae6547c54ab46f4f3901ea9" title="有効なファイルパスを探索します。" alt="" coords="773,669,924,710"/>
<area shape="poly" title=" " alt="" coords="695,651,759,666,757,671,693,656"/>
<area shape="rect" href="class_cgi_execution_state.html#aecf27444a140a66641a2b9a35327fca5" title="CGIが必要である場合にCGIスクリプト実行処理を行います。" alt="" coords="779,263,918,303"/>
<area shape="poly" title=" " alt="" coords="688,609,712,590,731,564,740,539,743,515,743,490,742,437,747,408,760,376,783,342,810,312,814,316,787,345,765,379,753,410,748,438,748,490,749,515,745,541,735,567,716,594,691,614"/>
<area shape="rect" href="class_content_extraction_state.html#a127f220bca1ccb5923933c272c6cefe0" title="HTTPリクエストに基づいてコンテンツ抽出処理を実行します。" alt="" coords="770,389,927,430"/>
<area shape="poly" title=" " alt="" coords="686,609,712,590,726,573,733,556,736,521,740,485,747,466,760,447,771,437,774,441,764,450,752,468,745,486,742,521,738,557,730,576,716,594,689,614"/>
<area shape="rect" href="class_file_path_generation_state.html#a4ee6c300ff2d365526e49a3a32cf0f11" title="HTTPリクエストに基づいてファイルパス生成処理を実行します。" alt="" coords="767,735,930,775"/>
<area shape="poly" title=" " alt="" coords="641,651,697,684,764,719,778,726,776,731,761,724,695,689,638,656"/>
<area shape="rect" href="class_header_parser_stream.html#a231d52a867b447e6cc8ebbe415d855bb" title="データを逐次的に読み取りながら解析します。" alt="" coords="777,800,920,841"/>
<area shape="poly" title=" " alt="" coords="624,651,682,716,721,752,764,785,773,790,770,795,761,789,718,757,678,720,620,655"/>
<area shape="rect" href="class_identify_location_state.html#aa290323ea9d092dfced1ecef61f21a4c" title="クライアントのリクエストURIに基づいて適切なサーバーとロケーションを識別しセットします。" alt="" coords="776,865,921,906"/>
<area shape="poly" title=" " alt="" coords="618,652,639,693,672,746,714,801,764,850,770,855,767,859,761,854,710,805,667,749,635,696,613,654"/>
<area shape="rect" href="class_parsing_body_state.html#a84c05e6122297eb58e0863755934ba79" title="HTTPリクエストの解析を行います。" alt="" coords="762,970,935,996"/>
<area shape="poly" title=" " alt="" coords="616,652,637,702,670,770,713,845,764,916,788,939,814,959,811,963,785,943,760,919,708,848,665,773,632,704,611,654"/>
<area shape="rect" href="class_response_str_build_state.html#aab058472aeb563041e918bed4c5c3b17" title="クライアントにsend()するレスポンスメッセージを構築します。" alt="" coords="770,555,927,595"/>
<area shape="poly" title=" " alt="" coords="693,609,754,594,755,600,695,614"/>
<area shape="rect" href="class_util_http_processing_step.html#a21282f874e910a6bbb63719d6199efe6" title="404や500など、ステータスコードに対応するエラーページの内容を返します。" alt="" coords="1313,497,1471,538"/>
<area shape="poly" title=" " alt="" coords="1185,494,1297,505,1297,511,1184,499"/>
<area shape="rect" href="class_util_http_processing_step.html#ab9931d09caf710018e021acf13e11e93" title="レスポンスボディを設定し、その長さに基づいてレスポンスのContent&#45;Lengthヘッダーを設定します。" alt="" coords="1591,389,1749,430"/>
<area shape="poly" title=" " alt="" coords="1184,475,1575,420,1576,425,1185,480"/>
<area shape="rect" href="class_response_str_build_state.html#a02838bcf03951383fff1f024c91bc109" title=" " alt="" coords="1276,563,1507,603"/>
<area shape="poly" title=" " alt="" coords="1185,569,1260,573,1260,578,1184,574"/>
<area shape="rect" href="class_cgi_execution_state.html#ac2ce6937814bad9d326cb72e28457bdd" title="CGIスクリプトを子プロセスで実行します。" alt="" coords="1000,201,1211,242"/>
<area shape="poly" title=" " alt="" coords="918,264,1002,244,1003,249,919,269"/>
<area shape="rect" href="class_cgi_execution_state.html#aaa36c8ac603138c4b2541ecb5e6c135a" title="環境変数をstd::stringからchar*に変換します。" alt="" coords="1312,5,1472,46"/>
<area shape="poly" title=" " alt="" coords="1121,199,1183,129,1226,90,1275,57,1296,46,1298,51,1277,61,1230,95,1187,133,1125,203"/>
<area shape="rect" href="class_cgi_execution_state.html#a3640636e5ea7f26c87481c7e0e1bab69" title="パイプを作成し、新しいプロセスをフォークします。" alt="" coords="1323,201,1461,242"/>
<area shape="poly" title=" " alt="" coords="1211,219,1307,219,1307,224,1211,224"/>
<area shape="rect" href="class_cgi_execution_state.html#af7a2830b1943e93db5a6e57ad1711498" title="CGIスクリプトを実行します。" alt="" coords="1323,267,1461,307"/>
<area shape="poly" title=" " alt="" coords="1198,240,1308,265,1306,270,1197,245"/>
<area shape="rect" href="class_cgi_execution_state.html#aff9df70d227ed984a62c5f44c284b116" title="CGIスクリプト実行の親プロセスの処理を実行します。" alt="" coords="1319,136,1464,177"/>
<area shape="poly" title=" " alt="" coords="1197,198,1304,174,1305,179,1198,203"/>
<area shape="rect" href="class_cgi_execution_state.html#a0a3236dd76cf8bd5a8115a348a296481" title="CGIプロセスのファイルディスクリプタをセットアップします。" alt="" coords="1287,332,1496,373"/>
<area shape="poly" title=" " alt="" coords="1139,240,1201,278,1277,317,1296,324,1294,329,1275,321,1199,283,1136,245"/>
<area shape="rect" href="class_cgi_execution_state.html#ad69e96a830c5ade8aa774703694a4413" title="CGIスクリプトの実行環境をstd::string型のvectorでセットアップします。" alt="" coords="1302,71,1481,111"/>
<area shape="poly" title=" " alt="" coords="1136,199,1199,160,1275,122,1294,114,1296,119,1277,127,1201,165,1139,203"/>
<area shape="poly" title=" " alt="" coords="1466,167,1509,187,1558,231,1599,281,1632,331,1655,374,1650,377,1627,334,1595,284,1554,234,1506,192,1463,172"/>
<area shape="rect" href="class_cgi_execution_state.html#a87dd9281aa48ff54b9c767bc58007601" title="フォークされたプロセスの終了を非ブロッキングで待ちます。" alt="" coords="1601,136,1739,177"/>
<area shape="poly" title=" " alt="" coords="1465,154,1585,154,1585,159,1465,159"/>
<area shape="rect" href="class_cgi_execution_state.html#a0ea4850cd9670c360522e59d4315b88f" title="環境変数の文字列を結合して作成し、vectorに追加します" alt="" coords="1555,71,1785,111"/>
<area shape="poly" title=" " alt="" coords="1482,88,1540,88,1540,94,1482,94"/>
<area shape="rect" href="class_content_extraction_state.html#a565b31e0c01130f683c56168e772a12d" title="ファイルの内容をHTTPレスポンスボディに読み込みます。" alt="" coords="993,389,1218,430"/>
<area shape="poly" title=" " alt="" coords="928,407,978,407,978,412,928,412"/>
<area shape="poly" title=" " alt="" coords="1218,407,1575,407,1575,412,1218,412"/>
<area shape="rect" href="class_header_parser_stream.html#a976623c54d7466c2e0b36bc2187f7479" title="ソケットからメッセージを受信します。" alt="" coords="1034,783,1177,823"/>
<area shape="poly" title=" " alt="" coords="920,813,1018,806,1018,812,921,818"/>
<area shape="rect" href="class_header_parser_stream.html#a4fb1ebe642377978c9ca699401f1c85a" title="受信したHTTPリクエストヘッダーを解析します。" alt="" coords="1312,832,1471,873"/>
<area shape="poly" title=" " alt="" coords="1178,813,1297,833,1296,839,1177,818"/>
<area shape="rect" href="class_header_parser_stream.html#aca8853f3ffd75cb79e8ab68d965d48c4" title="HTTPリクエストボディを受信します。" alt="" coords="1317,767,1467,807"/>
<area shape="poly" title=" " alt="" coords="1177,796,1301,789,1301,795,1178,802"/>
<area shape="rect" href="class_header_parser_stream.html#adade1c979989d5670bc8759c6318dd2a" title="受信したデータをベクターに追加します。" alt="" coords="1590,709,1750,750"/>
<area shape="poly" title=" " alt="" coords="1168,779,1220,765,1276,752,1354,741,1433,734,1575,727,1575,733,1434,739,1354,747,1276,758,1221,770,1169,785"/>
<area shape="rect" href="class_header_parser_stream.html#adf1b4d67ca01d835bf3fd4102ec6e608" title="HTTPリクエストヘッダーを解析します。" alt="" coords="1594,840,1746,881"/>
<area shape="poly" title=" " alt="" coords="1472,852,1579,855,1578,860,1472,857"/>
<area shape="rect" href="class_header_parser_stream.html#a0a4d53d99544647884a82e0cc2203936" title="HTTPリクエストラインを解析します。" alt="" coords="1598,775,1742,815"/>
<area shape="poly" title=" " alt="" coords="1471,833,1583,810,1584,815,1473,839"/>
<area shape="rect" href="class_header_parser_stream.html#ac07c7ad79d2dc56ce06eb41e5cbf5235" title="特定のHTTPヘッダーを処理し、関連する情報を格納します。" alt="" coords="1833,840,1992,881"/>
<area shape="poly" title=" " alt="" coords="1747,858,1817,858,1817,863,1747,863"/>
<area shape="poly" title=" " alt="" coords="1467,769,1575,747,1576,752,1468,774"/>
<area shape="rect" href="class_identify_location_state.html#a5c4f6cc671ed7dad98dd5fa58feae69c" title="クライアントのリクエストURIに基づいて適切な LocationDirective を識別します。" alt="" coords="995,865,1216,906"/>
<area shape="poly" title=" " alt="" coords="921,883,979,883,979,888,921,888"/>
<area shape="rect" href="class_identify_location_state.html#a617243d028b31872ffbe3719c39abf27" title="一致する LocationDirective を見つけます。" alt="" coords="1290,901,1494,942"/>
<area shape="poly" title=" " alt="" coords="1217,897,1274,904,1273,910,1216,902"/>
<area shape="rect" href="class_identify_location_state.html#a76736f8586e16547bfe15a23f03f887e" title="URIパターンがロケーションディレクティブに一致するかを判断します。" alt="" coords="1597,905,1743,946"/>
<area shape="poly" title=" " alt="" coords="1495,920,1582,922,1582,927,1494,926"/>
<area shape="rect" href="class_parsing_body_state.html#a0f773ef745b2d1d6926a02a14be8623f" title="リクエストURIから拡張子を抽出します。" alt="" coords="1001,931,1210,971"/>
<area shape="poly" title=" " alt="" coords="935,970,986,963,986,969,936,975"/>
<area shape="rect" href="class_parsing_body_state.html#a869dc59d24bb341260124ce9b9a31f24" title="URIから&quot;.cgi&quot;が存在する場合、その後に続くpathinfoとクエリ文字列を抽出します" alt="" coords="1008,996,1203,1037"/>
<area shape="poly" title=" " alt="" coords="936,992,992,999,992,1004,935,997"/>
<area shape="rect" href="class_parsing_body_state.html#ac4e24d9a1e9f5cc6ba348340f2c3eb58" title="HTTPリクエストボディを解析します。" alt="" coords="983,1061,1228,1087"/>
<area shape="poly" title=" " alt="" coords="874,994,923,1020,984,1046,1012,1054,1010,1059,982,1051,921,1025,871,999"/>
<area shape="rect" href="class_parsing_body_state.html#a038ea446c8c7688dfd53af4afd944c9d" title=" " alt="" coords="1306,1020,1478,1061"/>
<area shape="poly" title=" " alt="" coords="1221,1058,1290,1049,1290,1055,1222,1063"/>
<area shape="rect" href="class_parsing_body_state.html#a85a43d44071d51ee96dd501ccc850d59" title="チャンクエンコーディングの際のリクエストボディを解析します" alt="" coords="1305,1085,1478,1126"/>
<area shape="poly" title=" " alt="" coords="1226,1084,1290,1092,1290,1097,1226,1090"/>
<area shape="poly" title=" " alt="" coords="910,551,1027,512,1029,517,912,557"/>
<area shape="poly" title=" " alt="" coords="928,570,1011,567,1011,573,928,575"/>
<area shape="poly" title=" " alt="" coords="928,590,1002,607,1001,612,927,595"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_afc2ce78b98367413538d7d84537b867e_icgraph.png" border="0" usemap="#aclass_network_service_afc2ce78b98367413538d7d84537b867e_icgraph" alt=""/></div>
<map name="aclass_network_service_afc2ce78b98367413538d7d84537b867e_icgraph" id="aclass_network_service_afc2ce78b98367413538d7d84537b867e_icgraph">
<area shape="rect" title="すべてのクライアントソケットからのリクエストを処理します。" alt="" coords="255,5,446,46"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="a8849b9c719cb649dbbbae76d9981da7c" name="a8849b9c719cb649dbbbae76d9981da7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8849b9c719cb649dbbbae76d9981da7c">&#9670;&#160;</a></span>handleSendResponses()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::handleSendResponses </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>クライアントへの応答を処理します。 </p>
<p>この関数は _pollfds を反復処理し、POLLOUT が設定されたクライアントに応答を送信します。 ソケットを閉じる必要があるかどうかもチェックし、必要であればソケット接続をクリーンアップします。 </p><dl class="section note"><dt>Note</dt><dd>※※※ segv注意: <a class="el" href="#a16ed9bd4de8e026601eca26611647507" title="ソケットを閉じ、関連するリソースをクリーンアップします。">closeAndCleanupSocket()</a>の中でイテレーターが一つ進みます ※※※ <br  />
 デクリメント（&ndash;itPollFd）と同様の効果を得るためにcontinueを行います </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a8849b9c719cb649dbbbae76d9981da7c_cgraph.png" border="0" usemap="#aclass_network_service_a8849b9c719cb649dbbbae76d9981da7c_cgraph" alt=""/></div>
<map name="aclass_network_service_a8849b9c719cb649dbbbae76d9981da7c_cgraph" id="aclass_network_service_a8849b9c719cb649dbbbae76d9981da7c_cgraph">
<area shape="rect" title="クライアントへの応答を処理します。" alt="" coords="5,88,196,129"/>
<area shape="rect" href="class_network_service.html#a16ed9bd4de8e026601eca26611647507" title="ソケットを閉じ、関連するリソースをクリーンアップします。" alt="" coords="260,5,437,46"/>
<area shape="poly" title=" " alt="" coords="158,85,243,55,263,49,264,54,245,60,159,90"/>
<area shape="rect" href="class_network_service.html#a7101de80b1b3b348f2012246c598b0e4" title="引数のイテレータがサーバーソケットを指しているかどうかを判断します。" alt="" coords="256,70,441,96"/>
<area shape="poly" title=" " alt="" coords="196,96,240,91,240,97,197,101"/>
<area shape="rect" href="class_network_service.html#af9cd04add0e426e95a9fc680b06db23e" title="クライアントソケットへの応答メッセージを送信します。" alt="" coords="244,120,453,145"/>
<area shape="poly" title=" " alt="" coords="197,115,228,118,228,123,196,120"/>
<area shape="rect" href="class_network_service.html#aa2dc5eec9dfb61797bd77abf5a44a218" title="クライアントのリクエストヘッダーに &quot;Connection: keep&#45;alive&quot; が存在するか確認します。" alt="" coords="253,169,444,210"/>
<area shape="poly" title=" " alt="" coords="162,127,245,155,265,162,263,167,243,160,160,132"/>
<area shape="rect" href="class_network_service.html#a648626623792dd4752c1daaffe876ffc" title="指定されたソケットの接続を閉じます。" alt="" coords="501,13,720,39"/>
<area shape="poly" title=" " alt="" coords="437,23,486,23,486,28,437,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a8849b9c719cb649dbbbae76d9981da7c_icgraph.png" border="0" usemap="#aclass_network_service_a8849b9c719cb649dbbbae76d9981da7c_icgraph" alt=""/></div>
<map name="aclass_network_service_a8849b9c719cb649dbbbae76d9981da7c_icgraph" id="aclass_network_service_a8849b9c719cb649dbbbae76d9981da7c_icgraph">
<area shape="rect" title="クライアントへの応答を処理します。" alt="" coords="255,5,445,46"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="a79b80b9a51d73a85bb99b0ac0560a0c4" name="a79b80b9a51d73a85bb99b0ac0560a0c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79b80b9a51d73a85bb99b0ac0560a0c4">&#9670;&#160;</a></span>handleServerEvents()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::handleServerEvents </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>全てのサーバーsocket(port)でPOLLINフラグをチェックします <br  />
 </p>
<p>ポーリングされたサーバーソケットのリストを反復処理し、POLLINイベントがある場合は新しい接続を受け入れます。</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>変数<ul>
<li>_pollfds: pollfd構造体の配列で、サーバーソケットのセット <br  />
</li>
<li>_pollfds[i].revents: リスニングソケットのイベントをチェックするためのフィールド <br  />
</li>
<li>POLLIN: 読み取り可能なデータがあることを示すイベントフラグ <br  />
 </li>
</ul>
</li>
</ul>
</dd>
<dd>
<br  />
<ul>
<li>リファクタリング時の留意事項: <br  />
<ul>
<li>ループ内で_pollfdsに要素が追加されるため、_pollfdsのiteratorは使用すると無限ループに陥る場合があります。</li>
<li>現在の実装は、サーバーディレクティブの数と同じ回数ループします。 </li>
</ul>
</li>
</ul>
</dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a79b80b9a51d73a85bb99b0ac0560a0c4_cgraph.png" border="0" usemap="#aclass_network_service_a79b80b9a51d73a85bb99b0ac0560a0c4_cgraph" alt=""/></div>
<map name="aclass_network_service_a79b80b9a51d73a85bb99b0ac0560a0c4_cgraph" id="aclass_network_service_a79b80b9a51d73a85bb99b0ac0560a0c4_cgraph">
<area shape="rect" title="全てのサーバーsocket(port)でPOLLINフラグをチェックします" alt="" coords="5,104,204,145"/>
<area shape="rect" href="class_network_service.html#a18b7f72724577a0fba37802fb36d8e7d" title="新しいクライアント接続を受け入れます。" alt="" coords="252,104,440,145"/>
<area shape="poly" title=" " alt="" coords="204,122,236,122,236,127,204,127"/>
<area shape="rect" href="class_network_service.html#a6fecddc50e233048c7e1632913dff0b5" title="新しいソケットを監視リストに追加します。" alt="" coords="496,5,680,46"/>
<area shape="poly" title=" " alt="" coords="388,101,487,57,506,49,508,54,489,61,390,106"/>
<area shape="rect" href="class_network_service.html#ae230dece0329581a121b72f4437e0518" title="クライアントの状態をもつクラスのインスタンスを作成し、配列に追加します。" alt="" coords="488,71,687,111"/>
<area shape="poly" title=" " alt="" coords="440,109,472,104,473,110,441,114"/>
<area shape="rect" href="class_network_service.html#a63bbb5ebfaed19591fb547b3f0cfffc5" title="クライアントソケットとリスニングポートのマッピングを設定します。" alt="" coords="497,136,678,177"/>
<area shape="poly" title=" " alt="" coords="441,134,482,140,481,145,440,139"/>
<area shape="rect" href="class_network_service.html#a34440b127df8820b685c1fd564b0a558" title="指定されたソケットをノンブロッキングモードに設定します。" alt="" coords="501,201,675,242"/>
<area shape="poly" title=" " alt="" coords="391,143,489,186,508,193,506,198,487,191,389,148"/>
<area shape="rect" href="class_port_mapping.html#af2565580060648e513ff1096677d5d83" title="指定されたサーバーソケットのリッスンポート番号を取得します。" alt="" coords="743,116,923,141"/>
<area shape="poly" title=" " alt="" coords="678,143,728,138,728,143,679,149"/>
<area shape="rect" href="class_port_mapping.html#a868fe44581e5fcc88863e86a890503cf" title="クライアントソケットとリッスンポートのマッピングを設定します。" alt="" coords="735,165,931,206"/>
<area shape="poly" title=" " alt="" coords="679,165,720,170,720,175,678,170"/>
<area shape="rect" href="class_port_mapping.html#a7988c74208b6c0ee10fe927ceac12490" title="指定されたキーに基づきポート番号をmapから取得します。std::map&lt;int, int&gt;型のmapに共通で使用します。" alt="" coords="979,116,1178,141"/>
<area shape="poly" title=" " alt="" coords="923,126,963,126,963,131,923,131"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a79b80b9a51d73a85bb99b0ac0560a0c4_icgraph.png" border="0" usemap="#aclass_network_service_a79b80b9a51d73a85bb99b0ac0560a0c4_icgraph" alt=""/></div>
<map name="aclass_network_service_a79b80b9a51d73a85bb99b0ac0560a0c4_icgraph" id="aclass_network_service_a79b80b9a51d73a85bb99b0ac0560a0c4_icgraph">
<area shape="rect" title="全てのサーバーsocket(port)でPOLLINフラグをチェックします" alt="" coords="255,5,453,46"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="aa669d89eac68ea824c823701a63c6030" name="aa669d89eac68ea824c823701a63c6030"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa669d89eac68ea824c823701a63c6030">&#9670;&#160;</a></span>initNetworkService()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::initNetworkService </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ネットワークサービスを初期化します。 </p>
<dl class="section note"><dt>Note</dt><dd>timeout 単位: ms </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_aa669d89eac68ea824c823701a63c6030_icgraph.png" border="0" usemap="#aclass_network_service_aa669d89eac68ea824c823701a63c6030_icgraph" alt=""/></div>
<map name="aclass_network_service_aa669d89eac68ea824c823701a63c6030_icgraph" id="aclass_network_service_aa669d89eac68ea824c823701a63c6030_icgraph">
<area shape="rect" title="ネットワークサービスを初期化します。" alt="" coords="779,5,968,46"/>
<area shape="rect" href="class_network_service.html#a54ae0e59338c8ffd4aabd39866bbf549" title="ネットワークサービスを再起動します。" alt="" coords="523,5,731,46"/>
<area shape="poly" title=" " alt="" coords="764,28,732,28,732,23,764,23"/>
<area shape="rect" href="class_server_maneger.html#a104f42d342bf9d6af9c45c200d22facd" title="サーバーのループを再起動します。" alt="" coords="255,13,475,39"/>
<area shape="poly" title=" " alt="" coords="507,28,476,28,476,23,507,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="a7101de80b1b3b348f2012246c598b0e4" name="a7101de80b1b3b348f2012246c598b0e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7101de80b1b3b348f2012246c598b0e4">&#9670;&#160;</a></span>isServerFd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool NetworkService::isServerFd </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; struct pollfd &gt;::iterator &amp;</td>          <td class="paramname"><span class="paramname"><em>itPollFds</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>引数のイテレータがサーバーソケットを指しているかどうかを判断します。 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">itPollFds</td><td>ポーリングで使用するイテレータ。 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>サーバーソケットであればtrue、そうでなければfalse。 </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a7101de80b1b3b348f2012246c598b0e4_icgraph.png" border="0" usemap="#aclass_network_service_a7101de80b1b3b348f2012246c598b0e4_icgraph" alt=""/></div>
<map name="aclass_network_service_a7101de80b1b3b348f2012246c598b0e4_icgraph" id="aclass_network_service_a7101de80b1b3b348f2012246c598b0e4_icgraph">
<area shape="rect" title="引数のイテレータがサーバーソケットを指しているかどうかを判断します。" alt="" coords="494,46,679,72"/>
<area shape="rect" href="class_network_service.html#afc2ce78b98367413538d7d84537b867e" title="すべてのクライアントソケットからのリクエストを処理します。" alt="" coords="255,5,446,46"/>
<area shape="poly" title=" " alt="" coords="478,46,446,42,447,37,479,41"/>
<area shape="rect" href="class_network_service.html#a8849b9c719cb649dbbbae76d9981da7c" title="クライアントへの応答を処理します。" alt="" coords="255,71,446,111"/>
<area shape="poly" title=" " alt="" coords="479,76,447,81,446,75,478,71"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,46,207,72"/>
<area shape="poly" title=" " alt="" coords="240,43,205,48,205,43,239,38"/>
<area shape="poly" title=" " alt="" coords="239,79,207,75,208,70,240,74"/>
</map>
</div>

</div>
</div>
<a id="a9e89f1cabbeac6f1b6f8fd5c2fdc49df" name="a9e89f1cabbeac6f1b6f8fd5c2fdc49df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e89f1cabbeac6f1b6f8fd5c2fdc49df">&#9670;&#160;</a></span>listenSocket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::listenSocket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_server_directive.html">ServerDirective</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>サーバーソケットをリスニング状態に設定します。 </p>
<p>listen()を呼び出して、サーバーソケットをクライアントからの接続要求を受け付ける状態にします。 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">config</td><td>サーバーの設定を含むServerDirectiveオブジェクト。 </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>listen()の呼び出しに失敗した場合に発生。 </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a9e89f1cabbeac6f1b6f8fd5c2fdc49df_icgraph.png" border="0" usemap="#aclass_network_service_a9e89f1cabbeac6f1b6f8fd5c2fdc49df_icgraph" alt=""/></div>
<map name="aclass_network_service_a9e89f1cabbeac6f1b6f8fd5c2fdc49df_icgraph" id="aclass_network_service_a9e89f1cabbeac6f1b6f8fd5c2fdc49df_icgraph">
<area shape="rect" title="サーバーソケットをリスニング状態に設定します。" alt="" coords="998,13,1192,39"/>
<area shape="rect" href="class_network_service.html#a44006dbf443e41fff6a628d72e356dd3" title=".confのサーバーディレクティブの設定に基づいてセットアップを行います。" alt="" coords="765,5,950,46"/>
<area shape="poly" title=" " alt="" coords="982,28,950,28,950,23,982,23"/>
<area shape="rect" href="class_server_maneger.html#ab5e04aaf80feab4ba0522ab9311cf18f" title="設定ファイルを解析(parse)し、サーバーごとのポートでlistenを行い、pollfdを準備します。" alt="" coords="523,13,717,39"/>
<area shape="poly" title=" " alt="" coords="750,28,718,28,718,23,750,23"/>
<area shape="rect" href="class_server_maneger.html#a104f42d342bf9d6af9c45c200d22facd" title="サーバーのループを再起動します。" alt="" coords="255,13,475,39"/>
<area shape="poly" title=" " alt="" coords="507,28,476,28,476,23,507,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="a63bbb5ebfaed19591fb547b3f0cfffc5" name="a63bbb5ebfaed19591fb547b3f0cfffc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63bbb5ebfaed19591fb547b3f0cfffc5">&#9670;&#160;</a></span>mapClientSocketToListeningPort()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::mapClientSocketToListeningPort </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>clientSocket</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>serverIndex</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>クライアントソケットとリスニングポートのマッピングを設定します。 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clientSocket</td><td>クライアントソケットのファイルディスクリプタ。 </td></tr>
    <tr><td class="paramname">serverIndex</td><td>リスニングサーバーのインデックス。 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>getListenPort:_serverSocketPortMapからサーバーportを返す <br  />
 ※ _serverSocketPortMap: key=サーバーソケットFD, value=サーバーポート番号 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a63bbb5ebfaed19591fb547b3f0cfffc5_cgraph.png" border="0" usemap="#aclass_network_service_a63bbb5ebfaed19591fb547b3f0cfffc5_cgraph" alt=""/></div>
<map name="aclass_network_service_a63bbb5ebfaed19591fb547b3f0cfffc5_cgraph" id="aclass_network_service_a63bbb5ebfaed19591fb547b3f0cfffc5_cgraph">
<area shape="rect" title="クライアントソケットとリスニングポートのマッピングを設定します。" alt="" coords="5,27,187,68"/>
<area shape="rect" href="class_port_mapping.html#af2565580060648e513ff1096677d5d83" title="指定されたサーバーソケットのリッスンポート番号を取得します。" alt="" coords="243,5,422,31"/>
<area shape="poly" title=" " alt="" coords="187,34,227,29,228,34,187,39"/>
<area shape="rect" href="class_port_mapping.html#a868fe44581e5fcc88863e86a890503cf" title="クライアントソケットとリッスンポートのマッピングを設定します。" alt="" coords="235,55,430,96"/>
<area shape="poly" title=" " alt="" coords="187,56,219,59,219,65,187,61"/>
<area shape="rect" href="class_port_mapping.html#a7988c74208b6c0ee10fe927ceac12490" title="指定されたキーに基づきポート番号をmapから取得します。std::map&lt;int, int&gt;型のmapに共通で使用します。" alt="" coords="478,5,677,31"/>
<area shape="poly" title=" " alt="" coords="423,16,463,16,463,21,423,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a63bbb5ebfaed19591fb547b3f0cfffc5_icgraph.png" border="0" usemap="#aclass_network_service_a63bbb5ebfaed19591fb547b3f0cfffc5_icgraph" alt=""/></div>
<map name="aclass_network_service_a63bbb5ebfaed19591fb547b3f0cfffc5_icgraph" id="aclass_network_service_a63bbb5ebfaed19591fb547b3f0cfffc5_icgraph">
<area shape="rect" title="クライアントソケットとリスニングポートのマッピングを設定します。" alt="" coords="737,5,919,46"/>
<area shape="rect" href="class_network_service.html#a18b7f72724577a0fba37802fb36d8e7d" title="新しいクライアント接続を受け入れます。" alt="" coords="501,5,689,46"/>
<area shape="poly" title=" " alt="" coords="722,28,690,28,690,23,722,23"/>
<area shape="rect" href="class_network_service.html#a79b80b9a51d73a85bb99b0ac0560a0c4" title="全てのサーバーsocket(port)でPOLLINフラグをチェックします" alt="" coords="255,5,453,46"/>
<area shape="poly" title=" " alt="" coords="485,28,454,28,454,23,485,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="a54ae0e59338c8ffd4aabd39866bbf549" name="a54ae0e59338c8ffd4aabd39866bbf549"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54ae0e59338c8ffd4aabd39866bbf549">&#9670;&#160;</a></span>restartNetworkService()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::restartNetworkService </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ネットワークサービスを再起動します。 </p>
<p>すべてのソケットを閉じ、config設定とマッピングをクリアした後、ネットワークサービスを初期化します。 </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a54ae0e59338c8ffd4aabd39866bbf549_cgraph.png" border="0" usemap="#aclass_network_service_a54ae0e59338c8ffd4aabd39866bbf549_cgraph" alt=""/></div>
<map name="aclass_network_service_a54ae0e59338c8ffd4aabd39866bbf549_cgraph" id="aclass_network_service_a54ae0e59338c8ffd4aabd39866bbf549_cgraph">
<area shape="rect" title="ネットワークサービスを再起動します。" alt="" coords="5,39,214,79"/>
<area shape="rect" href="class_network_service.html#a2cf75b7a3d9f4f6ffb04501be4a4f151" title="すべてのソケットの接続を閉じ、関係するデータを削除します。" alt="" coords="268,5,444,46"/>
<area shape="poly" title=" " alt="" coords="214,42,252,37,252,42,215,48"/>
<area shape="rect" href="class_network_service.html#aa669d89eac68ea824c823701a63c6030" title="ネットワークサービスを初期化します。" alt="" coords="262,71,450,111"/>
<area shape="poly" title=" " alt="" coords="215,70,246,74,246,79,214,75"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a54ae0e59338c8ffd4aabd39866bbf549_icgraph.png" border="0" usemap="#aclass_network_service_a54ae0e59338c8ffd4aabd39866bbf549_icgraph" alt=""/></div>
<map name="aclass_network_service_a54ae0e59338c8ffd4aabd39866bbf549_icgraph" id="aclass_network_service_a54ae0e59338c8ffd4aabd39866bbf549_icgraph">
<area shape="rect" title="ネットワークサービスを再起動します。" alt="" coords="523,5,731,46"/>
<area shape="rect" href="class_server_maneger.html#a104f42d342bf9d6af9c45c200d22facd" title="サーバーのループを再起動します。" alt="" coords="255,13,475,39"/>
<area shape="poly" title=" " alt="" coords="507,28,476,28,476,23,507,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="af9cd04add0e426e95a9fc680b06db23e" name="af9cd04add0e426e95a9fc680b06db23e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9cd04add0e426e95a9fc680b06db23e">&#9670;&#160;</a></span>sendResponse()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int NetworkService::sendResponse </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>socketFd</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>msg</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>クライアントソケットへの応答メッセージを送信します。 </p>
<p>この関数は、send() システムコールを使用して指定されたソケットにメッセージを送信します。 メッセージの長さは 'len' で指定されます。 メッセージが単一のパケットで送信できないほど長い場合、EMSGSIZE エラーコードを返し、メッセージを送信しません。</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socketFd</td><td>送信先のソケットのファイルディスクリプタ。 </td></tr>
    <tr><td class="paramname">msg</td><td>送信するメッセージ。 </td></tr>
    <tr><td class="paramname">len</td><td>メッセージの長さ。</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>ソケットFdが無効な場合またはsend()が失敗した場合。</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>send() 関数および sendto() システムコールおよび sendmsg() システムコールは、メッセージを別のソケットに送信するのに使用されます。 <br  />
 send() 関数は、ソケットが 接続された 状態にあるときにだけ使用できるメッセージの長さは len で指定します。 メッセージが長すぎて基層となるプロトコルを不可分に通過できない場合、 エラー EMSGSIZE を返し、メッセージを送信しません。 <br  />
 送信するメッセージを保持するスペースがソケットに無い場合 send() は通常ブロックします。 ただし、ソケットが非ブロッキング入出力モードに設定されている場合は別です。 </dd></dl>
<dl class="section see"><dt>See also</dt><dd>send(2) man ページ: <a href="https://nxmnpg.lemoda.net/ja/2/send">https://nxmnpg.lemoda.net/ja/2/send</a> </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_af9cd04add0e426e95a9fc680b06db23e_icgraph.png" border="0" usemap="#aclass_network_service_af9cd04add0e426e95a9fc680b06db23e_icgraph" alt=""/></div>
<map name="aclass_network_service_af9cd04add0e426e95a9fc680b06db23e_icgraph" id="aclass_network_service_af9cd04add0e426e95a9fc680b06db23e_icgraph">
<area shape="rect" title="クライアントソケットへの応答メッセージを送信します。" alt="" coords="493,13,702,39"/>
<area shape="rect" href="class_network_service.html#a8849b9c719cb649dbbbae76d9981da7c" title="クライアントへの応答を処理します。" alt="" coords="255,5,445,46"/>
<area shape="poly" title=" " alt="" coords="477,28,446,28,446,23,477,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="a44006dbf443e41fff6a628d72e356dd3" name="a44006dbf443e41fff6a628d72e356dd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44006dbf443e41fff6a628d72e356dd3">&#9670;&#160;</a></span>setupEachServer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::setupEachServer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_server_directive.html">ServerDirective</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>.confのサーバーディレクティブの設定に基づいてセットアップを行います。 </p>
<p>サーバーソケットの作成、アドレス設定、バインド、リスニング状態の設定を行います。 また、ソケットをポーリング用のファイルディスクリプタセットに追加します。 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">config</td><td>サーバーの設定を含むServerDirectiveオブジェクト。 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>listen()まではUNIXの基本的な流れです。 <br  />
 poll()するために、struct pollfdを作成してvectorに追加します。 <br  />
 サーバーのソケットとポート番号をmapで管理します。 </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://daeudaeu.com/c-http-server/#execute">https://daeudaeu.com/c-http-server/#execute</a> <br  />
 <a href="https://research.nii.ac.jp/~ichiro/syspro98/wwwserver.html">https://research.nii.ac.jp/~ichiro/syspro98/wwwserver.html</a> <br  />
 <a href="https://beej.us/guide/bgnet/html/#system-calls-or-bust">https://beej.us/guide/bgnet/html/#system-calls-or-bust</a> <br  />
 書籍：TCP/IPソケットプログラミング </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a44006dbf443e41fff6a628d72e356dd3_cgraph.png" border="0" usemap="#aclass_network_service_a44006dbf443e41fff6a628d72e356dd3_cgraph" alt=""/></div>
<map name="aclass_network_service_a44006dbf443e41fff6a628d72e356dd3_cgraph" id="aclass_network_service_a44006dbf443e41fff6a628d72e356dd3_cgraph">
<area shape="rect" title=".confのサーバーディレクティブの設定に基づいてセットアップを行います。" alt="" coords="5,153,190,194"/>
<area shape="rect" href="class_network_service.html#a6fecddc50e233048c7e1632913dff0b5" title="新しいソケットを監視リストに追加します。" alt="" coords="245,5,430,46"/>
<area shape="poly" title=" " alt="" coords="117,151,168,103,201,78,236,55,246,50,249,55,239,60,204,82,172,107,120,155"/>
<area shape="rect" href="class_network_service.html#a76eb3eb24ee923721a827e11d5bf7234" title="サーバーソケットにアドレスをバインドします。" alt="" coords="251,70,424,96"/>
<area shape="poly" title=" " alt="" coords="137,150,184,128,237,106,261,98,262,103,239,111,186,132,139,155"/>
<area shape="rect" href="class_network_service.html#abb307c95e97d912803bff29f67f533ca" title="サーバーアドレスを設定します。" alt="" coords="250,120,425,161"/>
<area shape="poly" title=" " alt="" coords="190,158,234,152,235,157,191,163"/>
<area shape="rect" href="class_network_service.html#acf04155926d7461e63432034869d23b7" title="サーバーソケットを作成します。" alt="" coords="239,185,436,226"/>
<area shape="poly" title=" " alt="" coords="191,183,224,188,223,193,190,189"/>
<area shape="rect" href="class_network_service.html#a9e89f1cabbeac6f1b6f8fd5c2fdc49df" title="サーバーソケットをリスニング状態に設定します。" alt="" coords="240,250,435,276"/>
<area shape="poly" title=" " alt="" coords="140,192,239,235,263,243,261,248,237,240,138,197"/>
<area shape="rect" href="class_port_mapping.html#a35afe8110e08ba6892784a82f9d18161" title="サーバーソケットとリッスンポートのマッピングを設定します。" alt="" coords="238,300,437,341"/>
<area shape="poly" title=" " alt="" coords="120,192,172,239,204,264,239,286,249,291,247,296,236,291,201,268,168,243,117,196"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a44006dbf443e41fff6a628d72e356dd3_icgraph.png" border="0" usemap="#aclass_network_service_a44006dbf443e41fff6a628d72e356dd3_icgraph" alt=""/></div>
<map name="aclass_network_service_a44006dbf443e41fff6a628d72e356dd3_icgraph" id="aclass_network_service_a44006dbf443e41fff6a628d72e356dd3_icgraph">
<area shape="rect" title=".confのサーバーディレクティブの設定に基づいてセットアップを行います。" alt="" coords="765,5,950,46"/>
<area shape="rect" href="class_server_maneger.html#ab5e04aaf80feab4ba0522ab9311cf18f" title="設定ファイルを解析(parse)し、サーバーごとのポートでlistenを行い、pollfdを準備します。" alt="" coords="523,13,717,39"/>
<area shape="poly" title=" " alt="" coords="750,28,718,28,718,23,750,23"/>
<area shape="rect" href="class_server_maneger.html#a104f42d342bf9d6af9c45c200d22facd" title="サーバーのループを再起動します。" alt="" coords="255,13,475,39"/>
<area shape="poly" title=" " alt="" coords="507,28,476,28,476,23,507,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="aa2dc5eec9dfb61797bd77abf5a44a218" name="aa2dc5eec9dfb61797bd77abf5a44a218"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2dc5eec9dfb61797bd77abf5a44a218">&#9670;&#160;</a></span>shouldKeepAlive()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool NetworkService::shouldKeepAlive </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>socketFd</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>クライアントのリクエストヘッダーに "Connection: keep-alive" が存在するか確認します。 </p>
<p>クライアントのリクエストに"Connection: keep-alive" ヘッダーが存在するかどうかを確認します。 <br  />
 </p><dl class="section note"><dt>Note</dt><dd>keep-aliveの場合、ソケットは閉じません。</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socketFd</td><td>確認するソケットのファイルディスクリプタ。</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>"Connection: close" が見つかれば true、それ以外は false。 </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_aa2dc5eec9dfb61797bd77abf5a44a218_icgraph.png" border="0" usemap="#aclass_network_service_aa2dc5eec9dfb61797bd77abf5a44a218_icgraph" alt=""/></div>
<map name="aclass_network_service_aa2dc5eec9dfb61797bd77abf5a44a218_icgraph" id="aclass_network_service_aa2dc5eec9dfb61797bd77abf5a44a218_icgraph">
<area shape="rect" title="クライアントのリクエストヘッダーに &quot;Connection: keep&#45;alive&quot; が存在するか確認します。" alt="" coords="493,5,683,46"/>
<area shape="rect" href="class_network_service.html#a8849b9c719cb649dbbbae76d9981da7c" title="クライアントへの応答を処理します。" alt="" coords="255,5,445,46"/>
<area shape="poly" title=" " alt="" coords="477,28,445,28,445,23,477,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,13,207,39"/>
<area shape="poly" title=" " alt="" coords="239,28,207,28,207,23,239,23"/>
</map>
</div>

</div>
</div>
<a id="a34440b127df8820b685c1fd564b0a558" name="a34440b127df8820b685c1fd564b0a558"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34440b127df8820b685c1fd564b0a558">&#9670;&#160;</a></span>switchToNonBlockingSocket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetworkService::switchToNonBlockingSocket </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>socket</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>指定されたソケットをノンブロッキングモードに設定します。 </p>
<p>この関数は、指定されたソケットのファイルディスクリプタのフラグを取得し、ノンブロッキングモードに設定するために変更します。 <br  />
 フラグの取得や設定に失敗した場合は、例外を投げます。</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>ノンブロッキングモードに設定するソケットのファイルディスクリプタ。 </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>フラグの取得または設定に失敗した場合。 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><br  />
<ul>
<li>参考:【fcntl(2) - Linux manual page】 <a href="https://man7.org/linux/man-pages/man2/fcntl.2.html">https://man7.org/linux/man-pages/man2/fcntl.2.html</a></li>
<li>参考:【ノンブロッキングI/Oと非同期I/Oの違いを理解する】 <a href="https://blog.takanabe.tokyo/2015/03/%E3%83%8E%E3%83%B3%E3%83%96%E3%83%AD%E3%83%83%E3%82%AD%E3%83%B3%E3%82%B0i/o%E3%81%A8%E9%9D%9E%E5%90%8C%E6%9C%9Fi/o%E3%81%AE%E9%81%95%E3%81%84%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B/">https://blog.takanabe.tokyo/2015/03/%E3%83%8E%E3%83%B3%E3%83%96%E3%83%AD%E3%83%83%E3%82%AD%E3%83%B3%E3%82%B0i/o%E3%81%A8%E9%9D%9E%E5%90%8C%E6%9C%9Fi/o%E3%81%AE%E9%81%95%E3%81%84%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B/</a> </li>
</ul>
</dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_network_service_a34440b127df8820b685c1fd564b0a558_icgraph.png" border="0" usemap="#aclass_network_service_a34440b127df8820b685c1fd564b0a558_icgraph" alt=""/></div>
<map name="aclass_network_service_a34440b127df8820b685c1fd564b0a558_icgraph" id="aclass_network_service_a34440b127df8820b685c1fd564b0a558_icgraph">
<area shape="rect" title="指定されたソケットをノンブロッキングモードに設定します。" alt="" coords="765,35,940,75"/>
<area shape="rect" href="class_network_service.html#a18b7f72724577a0fba37802fb36d8e7d" title="新しいクライアント接続を受け入れます。" alt="" coords="526,5,714,46"/>
<area shape="poly" title=" " alt="" coords="749,45,714,40,715,35,750,39"/>
<area shape="rect" href="class_server_maneger.html#ab5e04aaf80feab4ba0522ab9311cf18f" title="設定ファイルを解析(parse)し、サーバーごとのポートでlistenを行い、pollfdを準備します。" alt="" coords="523,70,717,96"/>
<area shape="poly" title=" " alt="" coords="750,70,718,74,717,69,750,65"/>
<area shape="rect" href="class_network_service.html#a79b80b9a51d73a85bb99b0ac0560a0c4" title="全てのサーバーsocket(port)でPOLLINフラグをチェックします" alt="" coords="266,5,464,46"/>
<area shape="poly" title=" " alt="" coords="510,28,465,28,465,23,510,23"/>
<area shape="rect" href="class_server_maneger.html#aa1a8f96cfe9f844cafc8fc5e36255ed7" title="サーバーのメインループを実行します。" alt="" coords="5,42,207,68"/>
<area shape="poly" title=" " alt="" coords="251,41,207,46,207,41,250,36"/>
<area shape="rect" href="class_server_maneger.html#a104f42d342bf9d6af9c45c200d22facd" title="サーバーのループを再起動します。" alt="" coords="255,70,475,96"/>
<area shape="poly" title=" " alt="" coords="507,86,476,86,476,80,507,80"/>
<area shape="poly" title=" " alt="" coords="239,72,207,69,207,63,239,67"/>
</map>
</div>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/network/<a class="el" href="_network_service_8hpp_source.html">NetworkService.hpp</a></li>
<li>srcs/network/details/<b>fcntlNonBlocking.cpp</b></li>
<li>srcs/network/details/<b>NetworkService.cpp</b></li>
<li>srcs/network/<b>handlePoll.cpp</b></li>
<li>srcs/network/<b>handleRecvRequests.cpp</b></li>
<li>srcs/network/<b>handleSendResponses.cpp</b></li>
<li>srcs/network/<b>handleServerEvents.cpp</b></li>
<li>srcs/network/<b>setupEachServer.cpp</b></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="class_network_service.html">NetworkService</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
